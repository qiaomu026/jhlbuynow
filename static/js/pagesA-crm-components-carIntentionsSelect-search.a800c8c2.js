(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesA-crm-components-carIntentionsSelect-search"],{"456b":function(e,t,i){"use strict";var n=i("6131"),a=i.n(n);a.a},"52f6":function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\n\n\n/* 行为相关颜色 */.uni-indexed-list__list[data-v-2d7cf676]{background-color:#fff;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;border-top-style:solid;border-top-width:1px;border-top-color:#dedede}.uni-indexed-list__item[data-v-2d7cf676]{font-size:14px;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-flex:1;-webkit-flex:1;flex:1;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.uni-indexed-list__item .logo-image[data-v-2d7cf676]{width:30px;height:30px;margin-right:10px}.uni-indexed-list__item-container[data-v-2d7cf676]{padding-left:15px;-webkit-box-flex:1;-webkit-flex:1;flex:1;position:relative;display:-webkit-box;display:-webkit-flex;display:flex;box-sizing:border-box;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;cursor:pointer}.uni-indexed-list__item-border[data-v-2d7cf676]{-webkit-box-flex:1;-webkit-flex:1;flex:1;position:relative;display:-webkit-box;display:-webkit-flex;display:flex;box-sizing:border-box;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;height:50px;padding:25px;padding-left:0;border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:#dedede}.uni-indexed-list__item-border .check-icon[data-v-2d7cf676]{width:%?35?%;height:%?35?%}.uni-indexed-list__item-border .uni-indexed-list__item-right[data-v-2d7cf676]{border-left:%?2?% solid #dedede;padding-left:%?16?%}.uni-indexed-list__item-border--last[data-v-2d7cf676]{border-bottom-width:0}.uni-indexed-list__item-content[data-v-2d7cf676]{-webkit-box-flex:1;-webkit-flex:1;flex:1;font-size:14px;color:#191919}.uni-indexed-list[data-v-2d7cf676]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.uni-indexed-list__title-wrapper[data-v-2d7cf676]{display:-webkit-box;display:-webkit-flex;display:flex;width:100%;background-color:#f7f7f7}.uni-indexed-list__title[data-v-2d7cf676]{padding:6px 12px;line-height:24px;font-size:16px;font-weight:500}',""]),e.exports=t},6131:function(e,t,i){var n=i("52f6");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("5e6a369d",n,!0,{sourceMap:!1,shadowMode:!1})},a610:function(e,t,i){"use strict";var n=i("f69f"),a=i.n(n);a.a},baf8:function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\n\n\n/* 行为相关颜色 */.brand-series-search-wrap[data-v-ff3edc64]{height:100vh}.brand-series-search-wrap .search-nav-wrap[data-v-ff3edc64]  .uni-search-bar{padding-right:0}.brand-series-search-wrap .search-nav-wrap[data-v-ff3edc64]  .uni-search-bar .uni-search-bar-content{background-color:#f6f7f9;padding:0 %?16?%;border-radius:%?8?%}.brand-series-search-wrap .search-nav-wrap[data-v-ff3edc64]  .search-image{display:none}.brand-series-search-wrap .search-nav-wrap .cancel-button[data-v-ff3edc64]{color:#606266}.brand-series-search-wrap .total-count[data-v-ff3edc64]{padding:%?24?% %?32?%;color:rgba(0,0,0,.45098039215686275);font-size:%?28?%;background-color:#f6f7f9}.brand-series-search-wrap .click-search-trigger[data-v-ff3edc64]{font-size:%?28?%;color:#868688;border-bottom:%?1?% solid #e7e7e7;padding-top:%?10?%;padding-bottom:%?28?%}.brand-series-search-wrap .page-content[data-v-ff3edc64]  .uni-indexed-list__item-content{font-size:16px}.brand-series-search-wrap .page-content .list-item-right .list-item-right-icon[data-v-ff3edc64]{width:%?24?%;height:%?24?%;margin-right:%?8?%}.brand-series-search-wrap .page-content .all-series-tag[data-v-ff3edc64]{--item-height:%?69?%;width:-webkit-fit-content;width:fit-content;height:var(--item-height);line-height:var(--item-height);display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;font-size:%?28?%;color:rgba(0,0,0,.6509803921568628);background:#f7f8fa;padding:0 %?12?%;border-radius:calc(var(--item-height) / 2)}.brand-series-search-wrap .page-content .all-series-tag.active[data-v-ff3edc64]{color:#e0a400;background:rgba(224,164,0,.2823529411764706)}.brand-series-search-wrap .page-content uni-text.uni-indexed-list__item-content[data-v-ff3edc64]{font-size:16px}.brand-series-search-wrap .page-content .uni-group .uni-group__content[data-v-ff3edc64]{padding:0}.brand-series-search-wrap .page-content .uni-group .uni-group__content .tag-select[data-v-ff3edc64]{line-height:%?40?%;padding:%?25?% %?15?% %?25?% %?30?%;color:#333;border-bottom:%?1?% solid #f0f0f0}',""]),e.exports=t},e717:function(e,t,i){"use strict";i.r(t);var n={o2NavBar:i("61fd").default,uniSearchBar:i("1c61").default,o2Icon:i("51db").default,uniDrawer:i("6e16").default,uniGroup:i("067e").default,tagSelect:i("c2dc").default},a=i("d0ff"),r=i("f3f3"),s=i("f07e"),d=i("c964"),c=(i("4de4"),i("7db0"),i("c740"),i("5db7"),i("4160"),i("caad"),i("d81d"),i("14d9"),i("a434"),i("73d9"),i("d3b7"),i("159b"),i("01c4")),o=i("4d75"),l={uniIcons:i("1a49").default},h=(i("a9e3"),{name:"CrmIndexedListItem",emits:["itemClick","rightClick"],props:{idx:{type:Number,default:0},title:{type:String,default:""},list:{type:Array,default:function(){return[]}},haveImage:{type:Boolean,default:!1},showSelect:{type:Boolean,default:!1},showSlots:{type:Boolean,default:!0}},mounted:function(){},methods:{onClick:function(e,t,i){this.$emit("itemClick",{idx:e,index:t,item:i})},rightClick:function(e,t,i,n){e.stopPropagation(),this.$emit("rightClick",t,i,n)}}}),u=h,f=(i("456b"),i("f0c5")),b=Object(f["a"])(u,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{ref:"refSelf",staticClass:"uni-indexed-list-item"},[i("v-uni-view",{staticClass:"uni-indexed-list__title-wrapper"},[e.list&&e.list.length>0?i("v-uni-text",{staticClass:"uni-indexed-list__title"},[e._v(e._s(e.title))]):e._e()],1),e.list&&e.list.length>0?i("v-uni-view",{staticClass:"uni-indexed-list__list"},e._l(e.list,(function(t,n){return i("v-uni-view",{key:n,staticClass:"uni-indexed-list__item",attrs:{"hover-class":"uni-indexed-list__item--hover"}},[i("v-uni-view",{staticClass:"uni-indexed-list__item-container"},[i("v-uni-view",{staticClass:"uni-indexed-list__item-border",class:{"uni-indexed-list__item-border--last":n===e.list.length-1}},[e.showSlots?[e.showSelect?i("v-uni-view",{staticStyle:{"margin-right":"20rpx"},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.onClick(e.idx,n,t)}}},[e._t("left",[t.checked?["checked",!0].includes(t.checked)?i("uni-icons",{attrs:{type:"checkbox-filled",size:"24",color:"#FAAD14"}}):"half"===t.checked?i("uni-icons",{attrs:{type:"minus",size:"24",color:"#FAAD14"}}):e._e():i("uni-icons",{attrs:{type:"circle",size:"24",color:"#EBEBEB"}})],{item:t,index:n})],2):e._e(),e.haveImage?i("v-uni-image",{staticClass:"logo-image",attrs:{src:t.pic,mode:"widthFix"},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.onClick(e.idx,n,t)}}}):e._e(),i("v-uni-text",{staticClass:"uni-indexed-list__item-content",class:t.checked?"item-check":"",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.onClick(e.idx,n,t)}}},[e._v(e._s(t.name))]),e.$scopedSlots.right?i("v-uni-view",{staticClass:"uni-indexed-list__item-right",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.rightClick(i,t,e.idx,n)}}},[e._t("right")],2):e._e()]:e._e()],2)],1)],1)})),1):e._e()],1)}),[],!1,null,"2d7cf676",null,!1,l,void 0),p=b.exports,v=i("56ae"),m=i("3d8c"),x={name:"CarIntentionsSelectSearch",components:{CrmIndexedListItem:p,IBottomBar:m["a"]},data:function(){return{xwCodes:[],keyword:"",isFirstSearch:!0,showClickSearchTrigger:!1,brandListData:[],seriesListData:[],selectedBrandSeries:[],activeBrandItem:null,carModels:{modelList:[],brandId:null},SERIES_ICON_SRC:o["e"]}},beforeMount:function(){var e=this;this.brandListData=[],this.$nextTick((function(){e.getDataFromVuex()}))},computed:{barHeight:function(){var e=Object(v["c"])();return e+"px"},navPaddingTop:function(){var e=Object(v["c"])(),t=e+"px";return"calc(".concat(t," + 20rpx)")},totalCount:function(){return this.brandListData.length+this.seriesListData.length},outputValue:function(){if(!this.selectedBrandSeries.length)return[];var e=this.selectedBrandSeries.flatMap((function(e){return e.intentions}));return e},showBrandListData:function(){return this.brandListData.filter((function(e){return 1===e.hitFlag}))}},methods:{getDataFromVuex:function(){var e=this;return Object(d["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("intentionSelect/getSelectedBrandSeries");case 2:e.selectedBrandSeries=t.sent;case 3:case"end":return t.stop()}}),t)})))()},handleSearchInput:function(e){e&&this.isFirstSearch&&(this.showClickSearchTrigger=!0),this.keyword=e},handleSearchConfirm:function(e){var t=this;return Object(d["a"])(Object(s["a"])().mark((function i(){var n,a,d,c,o,l,h,u,f,b;return Object(s["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=e.value,t.keyword=n,uni.showLoading({title:"加载中",mask:!0}),i.prev=3,i.next=6,t.$http.post("".concat(t.$requestUrl.crm.searchBrandSeriesByName),{name:n});case 6:if(a=i.sent,d=a.data,uni.hideLoading(),t.showClickSearchTrigger=!1,t.isFirstSearch=!1,0===d.code){i.next=13;break}return i.abrupt("return");case 13:c=[],o=0,l={},h={},u={},f={},b={},t.selectedBrandSeries.forEach((function(e){var t=e.brandId,i=e.series,n=e.allSeriesSelected;u[t]=n?"checked":"half",i.forEach((function(e){f[e.seriesId]=!0})),n&&(b[t]=!0)})),t.brandListData=(d.data||[]).map((function(e,t){var i=e.brandInfo,n=e.seriesDtoList;l[i.id]=t;var a=[],s=[];return n.forEach((function(e,n){var d={brandId:i.id,brandName:i.name,seriesId:e.id,seriesName:e.name};h[e.id]=o,s.push({seriesId:e.id,seriesName:e.name,seriesIndexInSeriesList:o}),b[i.id]&&(f[e.id]=!0);var l=!!f[e.id]&&"checked";c.push(Object(r["a"])(Object(r["a"])({id:e.id,name:e.name},d),{},{checked:l,brandIndexInBrandList:t,seriesIndexInSeriesList:o}));var u=e.siftName,p=a.findIndex((function(e){return e.name===u}));-1!==p?a[p].children.push(Object(r["a"])(Object(r["a"])({id:e.id,name:e.name,label:e.name,value:e.id},d),{},{checked:l,indexInAllSeriesOfBrand:n,seriesIndexInSeriesList:o})):a.push({name:u,children:[Object(r["a"])(Object(r["a"])({id:e.id,name:e.name,label:e.name,value:e.id},d),{},{checked:l,indexInAllSeriesOfBrand:n,seriesIndexInSeriesList:o})]}),o++})),{pic:i.logo,checked:u[i.id]||!1,level:1,hitFlag:i.hitFlag,brandId:i.id,brandName:i.name,name:i.name,modelList:a,allSeries:s}})),t.seriesListData=c,i.next=28;break;case 25:i.prev=25,i.t0=i["catch"](3),uni.hideLoading();case 28:return i.prev=28,uni.hideLoading(),i.finish(28);case 31:case"end":return i.stop()}}),i,null,[[3,25,28,31]])})))()},handleClickCancel:function(){this.$Router.back()},updateCheckedTypesInBrandList:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!["checked","half",!0,!1].includes(t)){var i=this.brandListData[e],n=i.barndId,a=this.selectedBrandSeries.find((function(e){return e.brandId===n}));t=this.activeBrandItem?Object(c["b"])(this.activeBrandItem.allSeriesTagSelected,this.activeBrandItem.series):Object(c["b"])(a.allSeriesSelected,a.series)}this.brandListData[e].checked=t},updateCheckedTypesInSeriesList:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.seriesListData[e].checked=t},handleBrandListItemClick:function(e){var t,i=this,n=e.item,a=e.index,s=this.seriesListData.flatMap((function(e,t){return e.brandId===n.brandId?Object(r["a"])(Object(r["a"])({},e),{},{indexInSeriesListData:t}):[]})),d=this.selectedBrandSeries.findIndex((function(e){return e.brandId===n.brandId}));-1!==d?(this.selectedBrandSeries.splice(d,1),t=!1):(this.selectedBrandSeries.push({brandId:n.brandId,brandName:n.name,series:[],allSeriesTagSelected:!0,intentions:[{brandId:n.brandId,brandName:n.name}]}),t="checked"),this.updateCheckedTypesInBrandList(a,-1===d&&"checked"),s.forEach((function(e){var n=e.indexInSeriesListData;i.updateCheckedTypesInSeriesList(n,t)}))},prepareActiveBrandItem:function(e){var t=e.brandId,i=e.brandIndexInBrandList,n=this.brandListData[i],r=this.selectedBrandSeries.findIndex((function(e){return e.brandId===t})),s=-1!==r?this.selectedBrandSeries[r].series:[];this.activeBrandItem={brandId:n.brandId,brandName:n.brandName,series:s,brandIndex:i,allSeriesTagSelected:["checked",!0].includes(this.brandListData[i].checked)};var d=n.allSeries;this.activeBrandItem.allSeriesInBrand=Object(a["a"])(d),this.activeBrandItem.allSeriesTagSelected&&!this.activeBrandItem.series.length&&(this.activeBrandItem.series=Object(a["a"])(d))},handleSeriesListItemClick:function(e){var t=e.item,i=(e.index,t.checked?"remove":"add");this.prepareActiveBrandItem({brandId:t.brandId,brandIndexInBrandList:t.brandIndexInBrandList}),this.handleClickSeriesItem(t,i)},handleListItemRightClick:function(e,t,i){var n=this;return Object(d["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=n.brandListData[i],n.prepareActiveBrandItem({brandId:e.brandId,brandIndexInBrandList:i}),n.carModels.brandId=e.brandId,n.carModels.modelList=a.modelList,n.$refs.showRight.open();case 5:case"end":return t.stop()}}),t)})))()},closeDrawer:function(){this.$refs.showRight.close()},handleDrawerOpenShut:function(e){e||(this.activeBrandItem=null)},handleClickAllSeries:function(){var e=this;Object(c["d"])()(this);var t=this.activeBrandItem,i=t.brandIndex,n=t.allSeriesTagSelected,a=t.brandId;this.updateCheckedTypesInBrandList(i,!!n);var s=this.seriesListData.flatMap((function(e,t){return e.brandId===a?Object(r["a"])(Object(r["a"])({},e),{},{indexInSeriesListData:t}):[]}));s.forEach((function(t){var i=t.indexInSeriesListData;e.updateCheckedTypesInSeriesList(i,!!n)}))},handleClickSeriesItem:function(e,t){Object(c["e"])(e,t)(this);var i=this.activeBrandItem,n=i.brandIndex;i.brandIndexInGroup;this.updateCheckedTypesInBrandList(n),this.updateCheckedTypesInSeriesList(e.seriesIndexInSeriesList,"add"===t)},handleClear:function(){var e=this;this.selectedBrandSeries=[],this.brandListData.forEach((function(t,i){e.updateCheckedTypesInBrandList(i,!1)})),this.seriesListData.forEach((function(t,i){e.updateCheckedTypesInSeriesList(i,!1)}))},handleConfirm:function(){var e=this;if(this.outputValue.length>5)uni.showToast({title:"最多添加5个品牌车系",icon:"none"});else{var t=this.$store.state.intentionSelect.currentActiveCode;this.selectedBrandSeries.length?this.$store.commit("intentionSelect/setValue",{code:t,value:this.outputValue}):this.$store.commit("intentionSelect/clearValue",t),this.$Router.back(),this.$nextTick((function(){e.$EventBus.$emit(o["b"])}))}}}},w=x,g=(i("a610"),Object(f["a"])(w,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"brand-series-search-wrap df fdc"},[i("o2-nav-bar",{attrs:{fixed:!0,title:"查询"},scopedSlots:e._u([{key:"statusBar",fn:function(){return[i("v-uni-view",{style:{height:e.barHeight}})]},proxy:!0}])}),i("v-uni-view",{staticClass:"search-nav-wrap",style:{paddingTop:e.navPaddingTop}},[i("v-uni-view",{staticClass:"search-nav df aic pr16"},[i("uni-search-bar",{staticClass:"mr4 f1",attrs:{"search-color":"#BFBFBF",value:e.keyword,"adjust-position":!1},on:{input:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSearchInput.apply(void 0,arguments)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSearchConfirm.apply(void 0,arguments)}},scopedSlots:e._u([{key:"left",fn:function(){return[i("o2-icon",{staticClass:"search-icon",attrs:{size:"28rpx",icon:"icon-SearchOutlined",color:"#BFBFBF"}})]},proxy:!0}])}),i("v-uni-view",{staticClass:"cancel-button fs14",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleClickCancel.apply(void 0,arguments)}}},[e._v("取消")])],1)],1),e.totalCount?i("v-uni-view",{staticClass:"total-count"},[e._v("共"+e._s(e.totalCount)+"项目符合条件")]):e.showClickSearchTrigger?i("v-uni-view",{staticClass:"click-search-trigger df aic jcc",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSearchConfirm({value:e.keyword})}}},[e._v("点击搜索品牌车系")]):e._e(),i("v-uni-view",{staticClass:"page-content ova f1"},[i("v-uni-view",{staticClass:"brand-list"},[i("crm-indexed-list-item",{attrs:{list:e.showBrandListData,title:"品牌","show-select":!0,"have-image":!0},on:{itemClick:function(t){arguments[0]=t=e.$handleEvent(t),e.handleBrandListItemClick.apply(void 0,arguments)},rightClick:function(t){arguments[0]=t=e.$handleEvent(t),e.handleListItemRightClick.apply(void 0,arguments)}},scopedSlots:e._u([{key:"right",fn:function(){return[i("v-uni-view",{staticClass:"list-item-right"},[i("v-uni-image",{staticClass:"list-item-right-icon",attrs:{src:e.SERIES_ICON_SRC}}),e._v("车系")],1)]},proxy:!0}])}),i("crm-indexed-list-item",{attrs:{list:e.seriesListData,title:"车系","show-select":!0},on:{itemClick:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSeriesListItemClick.apply(void 0,arguments)}}})],1),i("uni-drawer",{ref:"showRight",attrs:{width:300,mode:"right","mask-click":!0},on:{chang:function(t){arguments[0]=t=e.$handleEvent(t),e.handleDrawerOpenShut.apply(void 0,arguments)}}},[i("v-uni-scroll-view",{style:{height:"100%",paddingTop:e.barHeight},attrs:{"scroll-y":"true"}},[i("uni-group",{attrs:{"margin-top":"20"}},[i("v-uni-view",{staticClass:"all-series-tag tc fs14",class:{active:e.activeBrandItem&&e.activeBrandItem.allSeriesTagSelected},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleClickAllSeries.apply(void 0,arguments)}}},[e._v("不限车系")])],1),e._l(e.carModels.modelList,(function(t,n){return i("uni-group",{key:n,attrs:{title:t.name||"默认","margin-top":"20"}},[t.children?[i("tag-select",{attrs:{value:e.activeBrandItem.series.map((function(e){return e.seriesId})),options:t.children,multiple:!0,flex:!0,"item-height":"69rpx"},on:{check:function(t){arguments[0]=t=e.$handleEvent(t),function(t,i,n){return e.handleClickSeriesItem(n,i)}.apply(void 0,arguments)}}})]:e._e()],2)}))],2)],1)],1),i("i-bottom-bar",{attrs:{count:e.outputValue.length},on:{clear:function(t){arguments[0]=t=e.$handleEvent(t),e.handleClear.apply(void 0,arguments)},confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.handleConfirm.apply(void 0,arguments)}}})],1)}),[],!1,null,"ff3edc64",null,!1,n,void 0));t["default"]=g.exports},f69f:function(e,t,i){var n=i("baf8");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var a=i("4f06").default;a("f057321a",n,!0,{sourceMap:!1,shadowMode:!1})}}]);