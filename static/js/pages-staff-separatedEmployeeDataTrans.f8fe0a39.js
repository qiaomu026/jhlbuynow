(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-staff-separatedEmployeeDataTrans"],{"6d0a":function(e,t,n){var a=n("98f5");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var i=n("4f06").default;i("b004d84e",a,!0,{sourceMap:!1,shadowMode:!1})},"76d9":function(e,t,n){"use strict";n.r(t);var a={o2NavBar:n("61fd").default},i=n("f07e"),o=n("c964"),r=n("f3f3"),c=n("fc11"),s=(n("4de4"),n("7db0"),n("a15b"),n("d81d"),n("14d9"),n("d3b7"),n("71ea")),l=n.n(s),p=(n("e143"),n("30ef")),u=n("26cb"),d=(l.a.OSS_URL,{Procurement:1,CustomerSales:2,CustomerAppraiser:3,SalesData:4,FinanceData:6}),f={data:function(){return{TransferTypeLabelMap:Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])(Object(c["a"])({},d.Procurement,"评估采购数据"),d.SalesData,"销售数据"),d.CustomerSales,"客户数据-销售"),d.CustomerAppraiser,"客户数据-评估师"),d.FinanceData,"业财数据"),user:null,data:[],platform:"",userSearchValue:"",selectedUser:null}},components:{LineInfo:p["a"]},computed:Object(r["a"])({isBefore:function(){return 0===this.user.transferStatus},isPending:function(){return 3===this.user.transferStatus},isFailed:function(){return 2===this.user.transferStatus},scrollPaddingBottom:function(){return 3===this.user.transferStatus?"":"160rpx"},typeNames:function(){var e=this;return"【".concat(this.data.map((function(t){return e.TransferTypeLabelMap[t.transferType]})).join("、"),"】")}},Object(u["mapState"])({staff:function(e){return e.staff}})),watch:{},onLoad:function(){var e=this,t=uni.getSystemInfoSync();this.platform=t.platform,this.user=Object(r["a"])({},this.$Route.query.user||{}),setTimeout((function(){e.getData()}),350)},onShow:function(){var e=this.staff,t=e.isOpen,n=e.activeType,a=e.selectedUser;if(t&&n){var i=this.data.find((function(e){return e.transferType===n}));i&&(i.receiveUserName=null===a||void 0===a?void 0:a.label,i.receiveAccountCode=null===a||void 0===a?void 0:a.value),this.$store.commit("staff/updateIsOpen",!1)}},methods:{minScrollHeight:function(){var e=uni.getSystemInfoSync(),t=e.statusBarHeight;t&&"calc(100vh - ".concat(t,"px - 104rpx - 120px)");return t?"calc(100vh - ".concat(t,"px - 104rpx - 120px)"):"calc(100vh - 104rpx - 30px - 120px)"},getData:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var n,a,o,r,c,s,l,p,u;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(uni.showLoading({}),0!==e.user.transferStatus){t.next=10;break}return n={accountCode:e.user.accountCode},t.next=5,e.$http.get(e.$newRequesturl.login.transferData,n);case 5:a=t.sent,o=a.data,0===(null===o||void 0===o?void 0:o.code)?(r=o.data,c=r.filter((function(t){return t.transferNumber>0&&e.TransferTypeLabelMap[t.transferType]})),e.data=c.map((function(e){return{receiveAccountCode:"",receiveUserName:"",id:"",transferType:e.transferType,transferNumber:e.transferNumber,transferStatus:0}}))):uni.showToast({title:"转移数据获取失败",icon:"none",duration:1e3}),t.next=16;break;case 10:return s={id:e.user.id},t.next=13,e.$http.get(e.$newRequesturl.login.transferDetail,s);case 13:l=t.sent,p=l.data,0===(null===p||void 0===p?void 0:p.code)?(u=p.data,e.data=u.filter((function(t){return t.transferNumber>0&&e.TransferTypeLabelMap[t.transferType]}))):uni.showToast({title:"转移数据获取失败",icon:"none",duration:1e3});case 16:uni.hideLoading();case 17:case"end":return t.stop()}}),t)})))()},handleSelectUser:function(e){var t=this.data.find((function(t){return t.transferType===e}));this.$store.commit("staff/updateSelectedUser",{label:t.receiveUserName,value:t.receiveAccountCode}),this.$Router.push({name:"separatedEmployeeDataTransSelectUser",params:{orgCode:this.user.orgCode,type:e}})},handleTrans:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var n,a,o,r,c,s,l;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=0;case 1:if(!(a<e.data.length)){t.next=9;break}if(o=e.data[a],o.receiveAccountCode){t.next=6;break}return uni.showToast({icon:"none",title:"请选择【".concat(e.TransferTypeLabelMap[o.transferType],"】的新归属人"),duration:1e3}),t.abrupt("return");case 6:a++,t.next=1;break;case 9:if(r=null===(n=e.user)||void 0===n?void 0:n.id,r){t.next=12;break}return t.abrupt("return",message.error("当前操作员工 id 数据获取失败"));case 12:return uni.showLoading({}),c={id:r,transferList:e.data.map((function(e){return{transferType:e.transferType,transferNumber:e.transferNumber,receiveAccountCode:e.receiveAccountCode,receiveUserName:e.receiveUserName}}))},t.prev=14,t.next=17,e.$http.post(e.$newRequesturl.login.transferSubmit,c);case 17:s=t.sent,l=s.data,0===l.code?(uni.showToast({title:"转移发起成功",icon:"none",duration:1e3}),setTimeout((function(){e.$Router.back(2)}),1e3)):uni.showToast({title:"转移发起失败",icon:"none",duration:1e3}),t.next=25;break;case 22:t.prev=22,t.t0=t["catch"](14),uni.hideLoading();case 25:uni.hideLoading();case 26:case"end":return t.stop()}}),t,null,[[14,22]])})))()},handleTransAgain:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var n,a,o,r;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return uni.showLoading({}),n=e.data.filter((function(e){return 2===e.transferStatus})),a={againIdList:n.map((function(e){return e.id}))},t.prev=3,t.next=6,e.$http.post(e.$newRequesturl.login.transferSubmitAgain,a);case 6:o=t.sent,r=o.data,0===r.code?(uni.showToast({title:"重新转移发起成功",icon:"none",duration:1e3}),setTimeout((function(){e.$Router.back(2)}),1e3)):uni.showToast({title:"重新转移发起失败",icon:"none",duration:1e3}),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](3),uni.hideLoading();case 14:uni.hideLoading();case 15:case"end":return t.stop()}}),t,null,[[3,11]])})))()},handleDeleteAccount:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var n,a,r,c;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e,a="确认删除该员工？",e.isBefore&&(a="员工数据未转移，确认删除该员工？"),e.isPending&&(a="员工数据转移中，确认删除该员工？"),e.isFailed&&(a="存在转移失败的数据，确认删除该员工？"),r="ios"===e.platform?"确认":"取消",c="ios"===e.platform?"取消":"确认",uni.showModal({title:"提示",content:a,confirmText:r,confirmColor:"#000000",cancelColor:"#F8B500",cancelText:c,success:function(){var t=Object(o["a"])(Object(i["a"])().mark((function t(a){var o,r,c,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o="ios"===e.platform?a.confirm:a.cancel,!o){t.next=16;break}return uni.showLoading({title:"删除"}),r={id:e.user.id},t.prev=4,t.next=7,e.$http.post(n.$newRequesturl.login.deleteSeparatedEmployee,r);case 7:c=t.sent,s=c.data,0===s.code?(uni.showToast({title:"删除成功",icon:"none",duration:1e3}),setTimeout((function(){e.$Router.back(2)}),1e3)):uni.showToast({title:"删除失败",icon:"none",duration:1e3}),t.next=15;break;case 12:t.prev=12,t.t0=t["catch"](4),uni.hideLoading();case 15:uni.hideLoading();case 16:case"end":return t.stop()}}),t,null,[[4,12]])})));return function(e){return t.apply(this,arguments)}}()});case 8:case"end":return t.stop()}}),t)})))()}}},b=f,m=(n("d820"),n("f0c5")),v=Object(m["a"])(b,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"ktc-template-page"},[n("o2-nav-bar",{staticStyle:{background:"white"},attrs:{backgroundColor:"#ffffff",title:"转移数据","status-bar":!0,inverted:!0}}),n("v-uni-view",{staticClass:"template_content"},[n("v-uni-view",{staticClass:"header-info"},[n("v-uni-view",{staticClass:"title"},[e._v(e._s(e.user.userName)+"（"+e._s(e.user.accountCode)+"）已退出企业")]),n("v-uni-view",{staticClass:"content"},[e._v("您可以将此员工的"+e._s(e.typeNames)+"归属更改为同一门店内任意在职员工")])],1),n("v-uni-view",{staticClass:"scroll-wrapper",style:{height:e.minScrollHeight(),paddingBottom:e.scrollPaddingBottom}},[n("v-uni-scroll-view",{staticClass:"user-list-scrollView content-info",staticStyle:{height:"100%"},attrs:{"scroll-y":"true"}},e._l(e.data,(function(t){return n("v-uni-view",{key:t.transferType,staticClass:"content-info-contain"},[n("v-uni-view",{staticClass:"info-top"},[n("v-uni-view",{staticClass:"type-name"},[e._v(e._s(e.TransferTypeLabelMap[t.transferType]))]),n("v-uni-view",{staticClass:"type-number"},[e._v("共"),n("span",{staticClass:"number"},[e._v(e._s(t.transferNumber))]),e._v("条数据")]),e.isBefore?e._e():n("v-uni-view",{staticClass:"type-status"},[0===t.transferStatus?n("v-uni-view",{staticClass:"pending"},[e._v("转移中")]):1===t.transferStatus?n("v-uni-view",{staticClass:"succeed"},[e._v("转移成功")]):2===t.transferStatus?n("v-uni-view",{staticClass:"failed"},[e._v("转移失败")]):e._e()],1)],1),e.isBefore?n("line-info",{attrs:{label:"新归属人",content:t.receiveUserName},on:{select:function(n){arguments[0]=n=e.$handleEvent(n),e.handleSelectUser(t.transferType)}}}):n("line-info",{attrs:{label:"新归属人","show-select":!1}},[e._v(e._s(t.receiveUserName))])],1)})),1)],1),e.isPending?e._e():n("v-uni-view",{staticClass:"content-bottom"},[n("v-uni-button",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleDeleteAccount.apply(void 0,arguments)}}},[e._v("删除员工")]),e.isBefore?n("v-uni-button",{staticClass:"primary",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleTrans.apply(void 0,arguments)}}},[e._v("发起转移")]):e.isFailed?n("v-uni-button",{staticClass:"primary",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.handleTransAgain.apply(void 0,arguments)}}},[e._v("重新发起转移")]):e._e()],1)],1)],1)}),[],!1,null,"4c941e16",null,!1,a,void 0);t["default"]=v.exports},"98f5":function(e,t,n){var a=n("24fb");t=a(!1),t.push([e.i,'@charset "UTF-8";\n\n\n/* 行为相关颜色 */.ktc-template-page[data-v-4c941e16]{width:100%;min-height:100vh;background-repeat:no-repeat;background-size:100% 100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;background-color:#f6f7f9}.ktc-template-page .template_content[data-v-4c941e16]{-webkit-box-flex:1;-webkit-flex:1;flex:1;width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.ktc-template-page .template_content .header-info[data-v-4c941e16]{background:#fff;padding:%?24?% %?32?%;width:100%}.ktc-template-page .template_content .header-info .title[data-v-4c941e16]{font-size:16px;margin-bottom:8px}.ktc-template-page .template_content .header-info .content[data-v-4c941e16]{font-size:12px;line-height:1.5;color:grey}.ktc-template-page .template_content .header-info .info-right[data-v-4c941e16]{font-size:16px;margin-left:auto}.ktc-template-page .template_content .header-info .info-right .status[data-v-4c941e16]{color:grey}.ktc-template-page .template_content .scroll-wrapper[data-v-4c941e16]{border-radius:%?32?%;font-size:15px;width:100%}.ktc-template-page .template_content .content-info[data-v-4c941e16]{width:100%;margin-bottom:80px;padding:16px}.ktc-template-page .template_content .content-info .content-info-contain[data-v-4c941e16]{background:#fff;border-radius:%?10?%;padding:%?32?% %?32?% %?8?%;margin-bottom:%?32?%}.ktc-template-page .template_content .content-info .content-info-contain .info-top[data-v-4c941e16]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;gap:%?16?%}.ktc-template-page .template_content .content-info .content-info-contain .info-top .type-name[data-v-4c941e16]{font-size:16px}.ktc-template-page .template_content .content-info .content-info-contain .info-top .type-number[data-v-4c941e16]{font-size:12px}.ktc-template-page .template_content .content-info .content-info-contain .info-top .type-number .number[data-v-4c941e16]{color:#f8b500;margin:0 4px}.ktc-template-page .template_content .content-info .content-info-contain .info-top .type-status[data-v-4c941e16]{margin-left:auto;font-size:15px}.ktc-template-page .template_content .content-info .content-info-contain .info-top .type-status .pending[data-v-4c941e16]{color:#f8b500}.ktc-template-page .template_content .content-info .content-info-contain .info-top .type-status .succeed[data-v-4c941e16]{color:#f8b500}.ktc-template-page .template_content .content-info .content-info-contain .info-top .type-status .failed[data-v-4c941e16]{color:#f8b500}.ktc-template-page .template_content .content-info .content-info-contain .line[data-v-4c941e16]{padding:0}.ktc-template-page .content-bottom[data-v-4c941e16]{background:#fff;position:fixed;left:0;right:0;bottom:0;display:-webkit-box;display:-webkit-flex;display:flex;gap:20px;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;padding:16px;min-height:72px;height:calc(72px + constant(safe-area-inset-bottom));padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.ktc-template-page .content-bottom uni-button[data-v-4c941e16]{padding:0 %?30?%;height:46px;text-align:center;line-height:46px;border-radius:24px;background:#ececec;-webkit-box-flex:1;-webkit-flex:auto;flex:auto}.ktc-template-page .content-bottom uni-button.primary[data-v-4c941e16]{background:#f8b500;color:#fff}.ktc-template-page .uni_input[data-v-4c941e16]{color:rgba(0,0,0,.8509803921568627);font-size:%?30?%;font-weight:400;line-height:%?46?%}.ktc-template-page[data-v-4c941e16]  uni-modal .uni-modal__ft{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-webkit-flex-direction:row-reverse;flex-direction:row-reverse;background:red}.ktc-template-page .nav-right-button[data-v-4c941e16]{color:#f8b500;font-size:%?32?%}.ktc-template-page .user-selected-popup[data-v-4c941e16]{font-size:%?32?%;font-weight:400;line-height:%?48?%}.ktc-template-page .user-selected-popup .search-section[data-v-4c941e16]{width:100%;height:%?104?%;background:#fff;padding:%?24?%;position:absolute;top:var(--MODAL-HEADER-HEIGHT);left:0;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-column-gap:16px;column-gap:16px}.ktc-template-page .user-selected-popup .search-section .search-button[data-v-4c941e16]{height:%?64?%;border-radius:24px;background:#f6f7f9;padding:0 %?24?%;-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.ktc-template-page .user-selected-popup .search-section .search-button uni-image[data-v-4c941e16]{height:%?28?%;width:%?28?%;margin-right:%?16?%}.ktc-template-page .user-selected-popup .search-section .search-button .search-button-title[data-v-4c941e16]{color:rgba(0,0,0,.45098039215686275);font-family:PingFang SC;font-size:%?24?%;font-style:normal;font-weight:400;line-height:%?42?%}.ktc-template-page .user-selected-popup .search-section .cancel-btn[data-v-4c941e16]{font-size:%?32?%}.ktc-template-page .user-selected-popup .popup-container[data-v-4c941e16]{padding:%?104?% %?32?% 0}.ktc-template-page .user-selected-popup .popup-container .user-item[data-v-4c941e16]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:start;-webkit-justify-content:start;justify-content:start;-webkit-box-align:center;-webkit-align-items:center;align-items:center;gap:8px;padding:%?16?% 0}.ktc-template-page .user-selected-popup .popup-container .user-item > uni-label[data-v-4c941e16]{-webkit-box-flex:1;-webkit-flex:1;flex:1}',""]),e.exports=t},d820:function(e,t,n){"use strict";var a=n("6d0a"),i=n.n(a);i.a}}]);