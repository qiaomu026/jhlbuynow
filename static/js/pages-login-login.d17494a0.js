(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"024c":function(t,e,n){t.exports=n.p+"assets/background.e9df5e53.png"},"1bd4":function(t,e,n){var i=n("d3b5");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var a=n("4f06").default;a("04ba244e",i,!0,{sourceMap:!1,shadowMode:!1})},"5c02":function(t,e,n){t.exports=n.p+"assets/slice17.f8ce6180.png"},a86a:function(t,e,n){"use strict";n.r(e);var i={o2Icon:n("51db").default,ktcDialog:n("dcac").default},a=n("f07e"),o=n("c964"),s=n("f3f3"),l=(n("d81d"),n("14d9"),n("ac1f"),n("00b4"),n("5319"),n("bb45")),c=n("71ea"),r=n.n(c),u=n("af75"),d=n("e143"),g=n("8d23"),h=n.n(g),b=n("26cb"),p=n("231d"),f=(r.a.OSS_URL,{data:function(){return{isCodeLoginType:!0,titleName:"",mobilePhone:"",captcha:"",account:"",password:"",countdownActive:!1,countdownRemaining:60,submitFlag:!1,uniqueId:"",siteInfo:this.$store.state.siteInfo,readFlag:!1,otherPhone:!1,agreementPopup:!1,isLoginOperating:!1,envSwitchClick:null,envSwitchClickTimeout:null,envSwitchList:["sit","uat"],envSwitchCount:0}},components:{},computed:Object(s["a"])(Object(s["a"])({},Object(b["mapState"])(["globalConfig"])),{},{isValidLogin:function(){return 6==this.captcha.length&&/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/.test(this.mobilePhone)}}),mounted:function(){this.titleName=this.$store.state.globalConfig.appName},methods:{goFun:function(){uni.navigateTo({url:"/pages/index-page/index-page"})},registerAction:function(){uni.navigateTo({url:"/pages/register/index"})},validateInput:function(t){var e=t.target.value;/^\d*$/.test(e)||(t.target.value=e.replace(/[^0-9]/g,""))},clauseQuery:function(t){var e="";this.$store.state.siteInfo;switch(t){case"用户协议":e="https://file.cartech.com.cn/metadata/tac/pub/tac_mall_user_prot/2/O2-PUB/STORE.html";break;case"隐私政策":e="https://file.cartech.com.cn/metadata/tac/pub/tac_mall_privacy_prot/2/O2-PUB/STORE.html";break}uni.setStorageSync("login_title",t),uni.setStorageSync("login_path",e),d["default"].prototype.$Router.push({name:"mpsec"})},combinParam:function(t){var e=this.$Route.query.trackParam||{};return Object(s["a"])(Object(s["a"])({},t),e)},goNum:function(){var t=this;this.countdownActive=!0,this.countdownRemaining=60,this.timer=setInterval((function(){t.countdownRemaining>0?t.countdownRemaining--:(t.countdownActive=!1,clearInterval(t.timer))}),1e3)},valifyMobliePhone:function(){this.valid("mobilePhone")},valid:function(t){var e={mobilePhone:{emptyTost:"请输入手机号",regExp:/^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\d{8}$/,regToast:"请输入11位正确手机号"}};return this[t]?!!e[t].regExp.test(this[t])||(uni.showToast({icon:"none",title:e[t].regToast,duration:1500}),!1):(uni.showToast({icon:"none",title:e[t].emptyTost,duration:1500}),!1)},checkboxTap:function(){this.readFlag?this.readFlag=!this.readFlag:this.agreementPopup=!0},agree:function(){this.agreementPopup=!1;this.readFlag=!this.readFlag,"sendCode"===this.agreeCallback&&this.getYzm(),"authLoginApp"===this.agreeCallback&&this.authLoginApp(this.loginType),"memberLogin"===this.agreeCallback&&this.memberLogin(),this.agreeCallback=""},disagree:function(){this.agreementPopup=!1;this.$Rangers.rangersLoginBtn("user_button_click",Object(s["a"])(Object(s["a"])({},this.combinParam({})),{intercept_button:"不同意"}))},getYzm:function(){var t=this;if(""!=this.mobilePhone){if(this.valid("mobilePhone")){if(!this.readFlag)return this.agreeCallback="sendCode",void this.checkboxTap();this.$http.post(this.$newRequesturl.login.newSendCode,{clientId:r.a.CLIENT_ID,phone:this.mobilePhone,type:"login"}).then((function(e){0==e.data.code?(t.uniqueId=e.data.data.uniqueId,t.goNum()):uni.showToast({icon:"none",title:"".concat(e.data.message),duration:1500})}))}}else uni.showToast({icon:"none",title:"请先输入手机号",duration:1500})},loginAndRegister:function(){var t=this,e=this.isCodeLoginType?this.verifyCodeParams():this.verifyPasswordParams();if(e)return!this.submitFlag&&(this.setTimeOutFlag&&clearTimeout(this.setTimeOutFlag),void(this.setTimeOutFlag=setTimeout((function(){return t.submit()}),200)))},verifyCodeParams:function(){var t;return!!this.isValidLogin&&(0==this.uniqueId.length?(uni.showToast({icon:"none",title:"请点击获取验证码",duration:1500}),!1):!!this.valid("mobilePhone")&&(this.readFlag?6===(null===(t=this.captcha)||void 0===t?void 0:t.length)||(uni.showToast({icon:"none",title:"请输入正确的验证码",duration:1500}),!1):(this.agreementPopup=!0,!1)))},verifyPasswordParams:function(){return""==this.account||null==this.account?(uni.showToast({icon:"none",title:"请输入用户账号",duration:1500}),!1):""==this.password||null==this.password?(uni.showToast({icon:"none",title:"请输入账号密码",duration:1500}),!1):!!this.readFlag||(this.agreementPopup=!0,!1)},submit:function(){var t=this;return Object(o["a"])(Object(a["a"])().mark((function e(){var n,i,o,s,c;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t,e.prev=1,!t.submitFlag){e.next=4;break}return e.abrupt("return",!1);case 4:if(t.submitFlag=!0,uni.showLoading({title:"加载中",mask:!0}),o=null,!t.isCodeLoginType){e.next=13;break}return e.next=10,t.$http.post(n.$newRequesturl.login.newlogin,{clientId:r.a.CLIENT_ID,phone:t.mobilePhone,verifyCode:t.captcha,uniqueId:t.uniqueId});case 10:o=e.sent,e.next=16;break;case 13:return e.next=15,t.$http.post(n.$newRequesturl.login.newlogin,{clientId:r.a.CLIENT_ID,phone:t.mobilePhone,verifyCode:t.captcha,uniqueId:t.uniqueId});case 15:o=e.sent;case 16:if(null===(i=o.data.data)||void 0===i||!i.failed){e.next=20;break}t.submitFlag=!1,e.next=27;break;case 20:if(t.submitFlag=!1,0==(null===(s=o)||void 0===s||null===(s=s.data)||void 0===s?void 0:s.code)){e.next=25;break}return uni.showToast({icon:"none",title:"".concat(o.data.message),duration:2e3}),uni.hideLoading(),e.abrupt("return");case 25:({regist_way:"手机验证码",user_regist_result:"成功"}),null!==(c=o)&&void 0!==c&&null!==(c=c.data)&&void 0!==c&&c.data&&(uni.$emit("genRid",!0),d["default"].prototype.$store.commit("login/save",["token",o.data.data.accessToken]),uni.setStorageSync("xsAppToken",o.data.data.accessToken),Object(p["d"])(t,(function(e){Object(l["b"])(t)}),(function(){Object(l["b"])(t)})),Object(p["e"])(),t.$http.post("/cartech-store-user/v1/userinfo/storerole",{shareId:uni.getStorageSync("shareInfo"),size:99999},{isNotLoad:!0}).then((function(e){var n;if(uni.hideLoading(),0===e.data.code&&(null===(n=e.data.data.records)||void 0===n?void 0:n.length)>0){t.uniqueId="";var i=e.data.data.records.map((function(t){var e=t.xwName,n=t.xwCode;return{name:e,label:e,value:n}}));d["default"].prototype.$store.commit("save",["activeTabbar","home"]),d["default"].prototype.$store.commit("store/save",["storeList",i]),d["default"].prototype.$store.commit("store/save",["selectedStoreArr",1===i.length?[i[0].value]:[]]),uni.reLaunch({url:"/pages/index-page/index-page"})}else uni.showModal({title:"提示",content:"请先联系平台管理员添加账号到门店后登录",showCancel:!1,confirmText:"知道了",success:function(e){e.confirm&&Object(p["a"])(t)}})})));case 27:setTimeout((function(){uni.hideLoading()}),1500),e.next=35;break;case 30:e.prev=30,e.t0=e["catch"](1),t.submitFlag=!1,uni.hideLoading(),t.loginFailed(e.t0);case 35:case"end":return e.stop()}}),e,null,[[1,30]])})))()},loginFailed:function(t){this.submitFlag=!1,uni.showToast({title:t.data.data.message||"登录失败",duration:1500,icon:"none"});var e={regist_way:"手机验证码",user_regist_result:"失败",failure_reason:t.data.message||"登录失败"};this.$Rangers.rangersLoginResult(vm.combinParam(e))},onLogoClick:function(t){var e=this;if("sit"===r.a.env||"uat"===r.a.env)if(null===this.envSwitchClick&&(this.envSwitchClick=t),this.envSwitchClick--,0===this.envSwitchClick){var n=this.envSwitchList[this.envSwitchCount%this.envSwitchList.length];Object(u["switchEnv"])(n),this.envSwitchCount++,this.$http.config.baseURL=h.a[n].MMC,uni.showToast({icon:"loading",title:"环境切换中",duration:1500}),Object(l["b"])().then((function(){uni.hideToast(),uni.showToast({icon:"none",title:"环境已切换到".concat(n),duration:1500})}))}else this.envSwitchClick>0&&(clearTimeout(this.envSwitchClickTimeout),this.envSwitchClickTimeout=setTimeout((function(){e.envSwitchClick=t}),500))}},beforeDestroy:function(){clearInterval(this.timer)}}),v=f,m=(n("c631"),n("f0c5")),w=Object(m["a"])(v,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"login"}},[i("div",{staticClass:"header"},[i("v-uni-view",{staticClass:"login_logo"},[i("v-uni-image",{attrs:{src:n("5c02")},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.onLogoClick(3)}}})],1),i("v-uni-view",{staticClass:"welcome_login"},[t._v("欢迎登录"+t._s(t.titleName?t.titleName:"MMC2.0"))])],1),t._e(),t.isCodeLoginType?i("div",{staticClass:"code-login content"},[i("div",{staticClass:"phone"},[i("v-uni-input",{attrs:{type:"number",min:"0",label:"手机号",placeholder:"请输入手机号",maxlength:"11"},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.valifyMobliePhone.apply(void 0,arguments)},input:function(e){arguments[0]=e=t.$handleEvent(e),t.validateInput.apply(void 0,arguments)}},model:{value:t.mobilePhone,callback:function(e){t.mobilePhone=e},expression:"mobilePhone"}})],1),i("div",{staticClass:"yzm"},[i("v-uni-input",{attrs:{type:"number",min:"0",placeholder:"请输入验证码",maxlength:"6"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.validateInput.apply(void 0,arguments)}},model:{value:t.captcha,callback:function(e){t.captcha=e},expression:"captcha"}}),t.countdownActive?i("v-uni-button",{attrs:{disabled:!0}},[t._v(t._s(t.countdownRemaining)+" 秒后重新获取")]):i("v-uni-button",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getYzm.apply(void 0,arguments)}}},[t._v("获取验证码")])],1)]):i("div",{staticClass:"password-login content"},[i("div",{staticClass:"password-input"},[i("v-uni-input",{attrs:{label:"手机号",placeholder:"请输入账号"},model:{value:t.account,callback:function(e){t.account=e},expression:"account"}})],1),i("div",{staticClass:"password-input"},[i("v-uni-input",{attrs:{placeholder:"请输入密码"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)]),i("div",{staticClass:"footer"},[i("v-uni-view",{staticClass:"read_agreement"},[i("v-uni-view",{staticClass:"check",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.readFlag=!t.readFlag}}},[i("o2-icon",{attrs:{color:t.readFlag?"var(--PRIMARY6)":"var(--GREY2)",icon:t.readFlag?"icon-CheckCircleFilled":"icon-SelectOutlined",size:"32rpx"}})],1),i("v-uni-view",{staticClass:"agreement_text"},[i("span",{staticStyle:{display:"inline"}},[t._v(t._s((t.otherPhone?"未注册的手机号验证后自动注册，且代表您":"我")+"已阅读并同意"))]),i("a",{staticStyle:{display:"inline","text-decoration":"none"},attrs:{href:"#"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.clauseQuery("用户协议")}}},[t._v("《"),i("span",[t._v(t._s(t.titleName))]),t._v("用户协议》")]),i("span",[t._v("和")]),i("a",{staticStyle:{display:"inline","text-decoration":"none"},attrs:{href:"#"},on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.clauseQuery("隐私政策")}}},[t._v("《隐私政策》")])])],1),t.agreementPopup?i("ktc-dialog",{attrs:{visible:t.agreementPopup,confirmButtonText:"已阅读并同意","cancel-button-text":"不同意"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.agree()},cancel:function(e){arguments[0]=e=t.$handleEvent(e),t.disagree()}}},[i("v-uni-view",{staticClass:"text-title"},[t._v("阅读并同意以下协议")]),i("v-uni-view",{staticClass:"text-box"},[t._v("为了保证您的个人信息安全，使用登录功能请下阅读并同意"),i("v-uni-text",{staticClass:"link",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clauseQuery("用户协议")}}},[t._v("《"),i("span",[t._v(t._s(t.titleName))]),t._v("用户使用协议》")]),t._v("和"),i("v-uni-text",{staticClass:"link",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clauseQuery("隐私政策")}}},[t._v("《隐私政策》")])],1)],1):t._e(),i("v-uni-button",{class:t.isValidLogin||!t.isCodeLoginType?"canTouch":"notTouch",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loginAndRegister.apply(void 0,arguments)}}},[t._v("立即登录")])],1)])}),[],!1,null,"ebe36b26",null,!1,i,void 0);e["default"]=w.exports},c631:function(t,e,n){"use strict";var i=n("1bd4"),a=n.n(i);a.a},d3b5:function(t,e,n){var i=n("24fb"),a=n("1de5"),o=n("024c");e=i(!1);var s=a(o);e.push([t.i,'@charset "UTF-8";\n\n\n/* 行为相关颜色 */\n/* 可以添加页面样式 */#login[data-v-ebe36b26]{background:url('+s+");background-size:cover;background-repeat:no-repeat;width:100%;height:100vh;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column\n  /* 设置容器高度为视口高度 */}.header[data-v-ebe36b26]{width:100%;height:30vh}.header .login_logo[data-v-ebe36b26]{margin-top:68px;text-align:center;margin-bottom:24px}.login_logo uni-image[data-v-ebe36b26]{width:58px;height:58px}.welcome_login[data-v-ebe36b26]{text-align:center;color:rgba(0,0,0,.9490196078431372);font-family:PingFang SC;font-size:%?56?%;font-style:normal;font-weight:600;line-height:normal}.login-type-content[data-v-ebe36b26]{margin:%?24?%;padding:%?12?%;border-radius:%?12?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;background:#f6f7f9;color:rgba(0,0,0,.45098039215686275);text-align:center;font-family:PingFang SC;font-size:%?28?%;font-style:normal;font-weight:400;line-height:%?42?%}.login-type-content .login-type[data-v-ebe36b26]{-webkit-box-flex:1;-webkit-flex:1;flex:1;height:%?64?%;border-radius:%?12?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.login-type-content .active-type[data-v-ebe36b26]{color:rgba(0,0,0,.8509803921568627);background-color:#fff;border-radius:%?12?%}.input-common[data-v-ebe36b26]{height:%?300?%}.content[data-v-ebe36b26]{width:100%;height:53vh;padding:12px}.code-login[data-v-ebe36b26]{padding-top:%?60?%}.code-login .phone[data-v-ebe36b26]{background-color:#f7f8f9;border-radius:8px}.code-login .phone uni-input[data-v-ebe36b26]{height:%?104?%}.code-login .yzm[data-v-ebe36b26]{background-color:#f7f8f9;margin-top:12px}.code-login .phone uni-input[data-v-ebe36b26]{padding-left:%?20?%}.code-login .phone uni-input div[data-v-ebe36b26]:nth-child(2n+1){color:rgba(0,0,0,.34901960784313724);text-align:left;font-family:PingFang SC;font-size:%?30?%;font-style:normal;line-height:23px}.code-login .yzm[data-v-ebe36b26]{background-color:#f7f8f9;margin-top:12px}.code-login .yzm uni-input[data-v-ebe36b26]{width:65%;height:%?104?%;float:left;background-color:#f7f8f9}.code-login .yzm uni-input[data-v-ebe36b26]{padding-left:%?20?%}.code-login .yzm uni-input div[data-v-ebe36b26]:nth-child(2n+1){color:rgba(0,0,0,.34901960784313724);text-align:left;font-family:PingFang SC;font-size:%?30?%;font-style:normal;font-weight:400;line-height:%?46?%}.code-login .yzm uni-button[data-v-ebe36b26]{width:35%;height:%?104?%;font-size:12px;line-height:%?104?%;float:right;background-color:#f7f8f9}.password-login[data-v-ebe36b26]{padding-top:%?60?%}.password-login .password-input uni-input[data-v-ebe36b26]{background-color:#f7f8f9;border-radius:8px;height:%?104?%;margin-bottom:%?24?%}.password-login .password-input uni-input[data-v-ebe36b26]{padding-left:%?20?%}.password-login .password-input uni-input div[data-v-ebe36b26]:nth-child(2n+1){color:rgba(0,0,0,.34901960784313724);text-align:left;font-family:PingFang SC;font-size:%?30?%;font-style:normal;line-height:23px}uni-button[data-v-ebe36b26]:after{border:none!important;outline:none!important}.footer[data-v-ebe36b26]{width:100%;height:10vh;padding-left:24px;padding-right:24px}.notTouch[data-v-ebe36b26]{background-color:#f8b500;opacity:.5;color:#fff}.canTouch[data-v-ebe36b26]{background-color:#f8b500;color:#fff}\n/* .footer button {\n  background-color: #F8B500;\n  color: #FFFCE6;\n} */.read_agreement[data-v-ebe36b26]{position:fixed;bottom:0;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:start;-webkit-align-items:flex-start;align-items:flex-start;width:86%;height:200px;\n  /* Assuming rpx is a custom unit */font-size:%?24?%;color:#8c8c8c;line-height:%?36?%;text-align:center}.read_agreement .check[data-v-ebe36b26]{margin-right:%?16?%;\n  /* Assuming rpx is a custom unit */display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;height:%?44?%\n  /* Assuming rpx is a custom unit */}.read_agreement .agreement_text[data-v-ebe36b26]{padding-top:%?6?%;\n  /* Assuming rpx is a custom unit */height:100%;max-width:%?580?%;\n  /* Assuming rpx is a custom unit */text-align:left}.read_agreement .agreement_text a[data-v-ebe36b26]{color:#595959}.registerBut[data-v-ebe36b26]{background:none;width:%?280?%;color:#a9a9a9;width:132.97px;margin-top:20px;color:rgba(0,0,0,.8509803921568627);text-align:center;font-family:PingFang SC;font-size:%?30?%;font-style:normal;font-weight:400;line-height:%?46?%}",""]),t.exports=e}}]);