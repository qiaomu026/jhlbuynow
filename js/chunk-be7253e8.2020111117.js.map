{"version":3,"sources":["webpack:///./src/page/Quality/QualityListPage.vue?6378","webpack:///./src/page/Quality/QualityListPage.vue?112c","webpack:///src/page/Quality/QualityListPage.vue","webpack:///./src/page/Quality/QualityListPage.vue?55d2","webpack:///./src/page/Quality/QualityListPage.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","goBack","networkError","sourceList","length","ref","goodsLoadFinished","scrollTop","$event","queryArticle","qualityClick","endLoading","_e","staticStyle","slot","_v","directives","name","rawName","value","expression","staticRenderFns","created","components","infiniteScroll","NetworkError","NavigationBar","activated","console","log","Object","assign","page","arr","$store","state","quality","defaultQualityList","dispatch","i","src","picUrl","setTimeout","document","querySelector","props","activeIndex","type","Number","data","isLoading","loading","loadingViewShow","beforeRouteLeave","dom","to","next","computed","methods","$router","push","params","startLoading","getQualityListAction","back","component"],"mappings":"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","file":"js/chunk-be7253e8.2020111117.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QualityListPage.vue?vue&type=style&index=0&id=186bcc56&scoped=true&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QualityListPage.vue?vue&type=style&index=0&id=186bcc56&scoped=true&lang=scss&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"flex-page\"},[_c('navigation-bar',{attrs:{\"pageName\":\"品质生活\"},on:{\"onLeftClick\":_vm.goBack}}),(!_vm.networkError && _vm.sourceList.length > 0)?_c('div',{staticClass:\"flex-full\"},[_c('infinite-scroll',{ref:\"scrollParent\",attrs:{\"dataSource\":_vm.sourceList,\"loadFinished\":_vm.goodsLoadFinished,\"reachBottomDistance\":1000,\"scrollTop\":this.scrollTop},on:{\"pullDownRefresh\":function($event){return _vm.queryArticle(true)},\"pullUpLoad\":function($event){return _vm.queryArticle()},\"itemClick\":_vm.qualityClick,\"endLoading\":_vm.endLoading}})],1):_vm._e(),(_vm.networkError)?_c('div',{staticStyle:{\"height\":\"300px\",\"padding-top\":\"50px\"}},[_c('NetworkError',[_c('div',{staticClass:\"refresh-btn\",attrs:{\"slot\":\"refreshMode\"},on:{\"click\":function($event){return _vm.queryArticle(true)}},slot:\"refreshMode\"},[_vm._v(\"\\n        重新加载\\n      \")])])],1):_vm._e(),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.loadingViewShow),expression:\"loadingViewShow\"}],staticClass:\"loading-view\",staticStyle:{\"top\":\"0px\",\"left\":\"0px\"}},[_c('van-loading',{attrs:{\"color\":\"#17B7BD\"}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"flex-page\">\r\n    <navigation-bar  @onLeftClick=\"goBack\" pageName=\"品质生活\" />\r\n    <div class=\"flex-full\" v-if=\"!networkError && sourceList.length > 0\">\r\n      <infinite-scroll\r\n        :dataSource=\"sourceList\"\r\n        @pullDownRefresh=\"queryArticle(true)\"\r\n        @pullUpLoad=\"queryArticle()\"\r\n        @itemClick=\"qualityClick\"\r\n        @endLoading=\"endLoading\"\r\n        :loadFinished=\"goodsLoadFinished\"\r\n        :reachBottomDistance=\"1000\"\r\n        :scrollTop=\"this.scrollTop\"\r\n        ref=\"scrollParent\"\r\n      ></infinite-scroll>\r\n    </div>\r\n    <div style=\"height:300px;padding-top: 50px;\" v-if=\"networkError\">\r\n      <NetworkError>\r\n        <div slot=\"refreshMode\" class=\"refresh-btn\" @click=\"queryArticle(true)\">\r\n          重新加载\r\n        </div>\r\n      </NetworkError>\r\n    </div>\r\n    <div class=\"loading-view\" v-show=\"loadingViewShow\" style=\"top: 0px; left: 0px;\">\r\n      <van-loading color=\"#17B7BD\" />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapState } from \"vuex\";\r\nimport infiniteScroll from \"../../components/infiniteScroll/infiniteScroll\";\r\nimport NetworkError from '../../common/networkError/NetworkError';\r\nimport NavigationBar from '@/common/currency/NavigationBar.vue';\r\nimport Vue from \"vue\";\r\nimport { ImagePreview, Toast, Loading, Dialog } from \"vant\";\r\nVue.use(ImagePreview, Toast, Loading, Dialog);\r\nexport default {\r\n  name: \"QualityDetailPage\",\r\n  created() {},\r\n  components: {\r\n    \"infinite-scroll\": infiniteScroll,\r\n    \"NetworkError\": NetworkError,\r\n    NavigationBar\r\n  },\r\n  activated () {\r\n    console.log(Object.assign({}, this.sourceList))\r\n    if(this.$route.params.reload){\r\n      this.sourceList = [];\r\n      this.page = 1;\r\n      var arr = this.$store.state.quality.defaultQualityList;\r\n      this.$store.dispatch(\"setDefaultQualityList\", []);\r\n      for(var i = 0; i < arr.length; i++) {\r\n        arr[i].src = arr[i].picUrl;\r\n      }\r\n      setTimeout(() => {\r\n        this.sourceList = arr;\r\n        this.queryArticle(false, true);\r\n      }, 200);\r\n      this.scrollTop = 0;\r\n    } else {\r\n      document.querySelector(\".vue-waterfall-easy-scroll\").scrollTop = this.scrollTop;\r\n    }\r\n  },\r\n\r\n  props: {\r\n    activeIndex: {\r\n      type: Number\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      isLoading: \"\",\r\n      loading: \"\",\r\n      sourceList: [],\r\n      scrollTop: 0,\r\n      //网络错误标识\r\n      networkError: false,\r\n      page: 1,\r\n      loadingViewShow: false,\r\n    };\r\n  },\r\n  beforeRouteLeave(to, from, next){\r\n    var dom = document.querySelector(\".vue-waterfall-easy-scroll\");\r\n    if(dom) {\r\n      this.scrollTop = dom.scrollTop;\r\n    }\r\n    console.log(to.name)\r\n    if(to.name == \"homePage\") {\r\n      this.sourceList = [];\r\n    }\r\n    next();\r\n  },\r\n  computed: {\r\n    ...mapState({\r\n      goodsLoadFinished: state => state.quality.articleFinished\r\n    })\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions([\"getQualityListAction\"]),\r\n   \r\n    qualityClick(item) {\r\n      let articleNo = item.value.articleNo;\r\n      let articlePic = item.value.src;\r\n      this.$router.push({ \r\n        name: \"qualityDetail\",\r\n        params: { \r\n            articleNo: articleNo,\r\n            articleImg: articlePic\r\n        } \r\n      });\r\n    },\r\n    startLoading() {\r\n      console.log(\"startloading\")\r\n      this.loadingViewShow = true;\r\n    },\r\n    endLoading() {\r\n      console.log(\"endloading\")\r\n      this.loadingViewShow = false;\r\n    },\r\n    queryArticle(isRefresh, isFirst) {\r\n      if(isRefresh || isFirst) {\r\n        this.page = 1;\r\n        this.startLoading();\r\n      }\r\n      this.getQualityListAction(this.page)\r\n        .then(list => {\r\n          this.networkError = false;\r\n          if(list.pageNum == this.page) {\r\n            this.page += 1;\r\n          } else {\r\n            return;\r\n          }\r\n          list.articleList.forEach((item, index) => {\r\n            if(index % 2 == 0) {\r\n              item.src = item.src.replace('xwjfile.juhaolian.cn', 'xwjfilea.juhaolian.cn');\r\n            }\r\n          })\r\n          if (isRefresh) {\r\n            this.sourceList = list.articleList;\r\n            console.log(\"refresh:\" + this.sourceList)\r\n            return;\r\n          }\r\n        \r\n          if(isFirst) {\r\n            var arr = list.articleList\r\n            arr.splice(0, 6);\r\n            this.sourceList = this.sourceList.concat(arr);\r\n            console.log(\"isFirst:\" + this.sourceList)\r\n          } else {\r\n            this.sourceList = this.sourceList.concat(list.articleList);\r\n            console.log(\"nomarl:\" + this.sourceList)\r\n          }\r\n\r\n          //  this.$refs.scrollParent.loadDataFinish();\r\n         \r\n        })\r\n        .catch(error => {\r\n          this.endLoading();\r\n          //  this.$refs.scrollParent?this.$refs.scrollParent.loadDataFinish():'';\r\n          if(isRefresh) {\r\n            this.networkError = true;\r\n          }\r\n          // this.$toast(error);\r\n        });\r\n    },\r\n    goBack() {\r\n      this.sourceList = [];\r\n      this.$router.back(-1);\r\n     // this.$destroy();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style  scoped lang=\"scss\">\r\n.flex-page {\r\n  height: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  .flex-full {\r\n    flex: 1;\r\n    overflow: hidden;\r\n  }\r\n  .refresh-btn {\r\n    border: 1px solid #B5B5B5;\r\n    width: 125px;\r\n    border-radius: 2rem;\r\n    height: 40px;\r\n    min-height: 30px !important;\r\n    line-height: 40px;\r\n    color: #444;\r\n    margin: 0 auto;\r\n    font-size: 16px;\r\n    margin-top: 10px;\r\n  }\r\n}\r\n/deep/.network {\r\n  background: #ffffff;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QualityListPage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./QualityListPage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./QualityListPage.vue?vue&type=template&id=186bcc56&scoped=true&\"\nimport script from \"./QualityListPage.vue?vue&type=script&lang=js&\"\nexport * from \"./QualityListPage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./QualityListPage.vue?vue&type=style&index=0&id=186bcc56&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"186bcc56\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}