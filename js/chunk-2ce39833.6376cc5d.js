(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2ce39833"],{"0865":function(t,i,e){"use strict";e.d(i,"b",(function(){return s})),e.d(i,"a",(function(){return o})),e.d(i,"d",(function(){return a})),e.d(i,"e",(function(){return c})),e.d(i,"c",(function(){return r})),e.d(i,"f",(function(){return u})),e.d(i,"g",(function(){return h}));var n=e("ba6a"),s=function(t){return new Promise((function(i,e){n["a"].post("hisense-systemServer/app/owner/ownerActivitiesController/getActiMsg.do",t,!0,"homeUrl",!1).then((function(t){i(t)})).catch((function(t){e(t)}))}))},o=function(t){return new Promise((function(i,e){n["a"].post("hisense-systemServer/app/owner/ownerActivitiesController/getActiMsgByActiCode.do",t,!0,"homeUrl").then((function(t){i(t)})).catch((function(t){e(t)}))}))},a=function(t){return new Promise((function(i,e){n["a"].post("hisense-systemServer/app/owner/ownerActivitiesController/getDetailMsgByDetailCode.do",t,!0,"homeUrl").then((function(t){i(t)})).catch((function(t){e(t)}))}))},c=function(t){return new Promise((function(i,e){n["a"].post("hisense-systemServer/app/owner/ownerActivitiesController/getIsActiDetailMsg.do",t,!0,"homeUrl").then((function(t){i(t)})).catch((function(t){e(t)}))}))},r=function(t){return new Promise((function(i,e){n["a"].post("hisense-systemServer/app/owner/ownerActivitiesController/deleteEnrol.do",t,!0,"homeUrl").then((function(t){i(t)})).catch((function(t){e(t)}))}))},u=function(t){return new Promise((function(i,e){n["a"].post("hisense-systemServer/app/owner/ownerActivitiesController/addActiEnrol.do",t,!0,"homeUrl").then((function(t){i(t)})).catch((function(t){e(t)}))}))},h=function(t){return new Promise((function(i,e){n["a"].post("hisense-systemServer/app/owner/ownerActivitiesController/getDetailByActiCode.do",t,!0,"homeUrl").then((function(t){i(t)})).catch((function(t){e(t)}))}))}},"21e2":function(t,i,e){"use strict";var n=e("f417"),s=e.n(n);s.a},a28c:function(t,i,e){"use strict";e.r(i);var n=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"propertyActivityDetail",class:{themeL:t.bindThemeL}},[e("navigation-bar",{attrs:{pageName:t.title,bothWidth:t.headerItemWidth},on:{onLeftClick:t.goBack}}),e("div",{staticClass:"activityHeader",style:{top:44+this.$stbHeight+"px"}},[e("div",{staticClass:"background_pic"},[t.activity.PIC_URL?e("img",{attrs:{src:t.activity.PIC_URL}}):t._e()]),e("div",{staticClass:"activityTitle"},[t._v(t._s(t.activity.ACTI_NAME))]),e("div",{staticClass:"activitySubTitle"},[t._v("当前房间"+t._s(t.ENROL_CNT)+"人报名")]),e("div",{staticClass:"list",staticStyle:{margin:"16px"}},[e("div",{staticClass:"oneLine item-input item-select",staticStyle:{"border-top":"none"},on:{click:t.sectionSelectClicked}},[e("span",{staticClass:"headerName"},[t._v("场次:")]),e("span",{staticClass:"item-note"},[t._v("\n          "+t._s(t.currentDetailData.DETAIL_NAME)+"\n        ")])]),t.isShowJoinInput?e("div",{staticClass:"oneLine"},[e("span",{staticClass:"headerName"},[t._v("参加人数:")]),e("span",{staticClass:"item-note",on:{click:function(i){return t.showJoinNums()}}},[e("label",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.joinNumber,expression:"joinNumber"}],staticClass:"inputNumber",attrs:{readonly:"",type:"number",placeholder:"请输入参加人数"},domProps:{value:t.joinNumber},on:{input:function(i){i.target.composing||(t.joinNumber=i.target.value)}}})])])]):t._e(),e("div",{staticClass:"oneLine"},[e("span",{staticClass:"headerName"},[t._v("人数上限/家庭:")]),e("span",{staticClass:"item-note"},[t._v(t._s(t.activity.LIMIT_MAX)+"人/家")])]),e("div",{staticClass:"oneLine"},[e("span",{staticClass:"headerName"},[t._v("当前场次已报名人数:")]),e("span",{staticClass:"item-note"},[t._v(t._s(t.ENROL_CNTS)+"/"+t._s(t.LIMIT_MAX)+"人")])]),e("div",{staticClass:"oneLine"},[e("span",{staticClass:"headerName"},[t._v("报名时间:")]),e("span",{staticClass:"item-note timeInfo"},[t._v("\n          "+t._s(t.activity.START_TIME)+"\n          至\n          "+t._s(t.activity.END_TIME)+"\n        ")])]),e("div",{staticClass:"oneLine"},[e("span",{staticClass:"headerName"},[t._v("场次时间:")]),e("span",{staticClass:"item-note timeInfo"},[t._v("\n          "+t._s(t.START_TIME)+"\n          至\n          "+t._s(t.END_TIME)+"\n        ")])])]),e("div",{staticClass:"oneLine activityHead",staticStyle:{"border-bottom":"none"}},[t._v("活动详情")]),e("div",{staticClass:"activityImg"},[e("p",{staticClass:"activityIntr",domProps:{innerHTML:t._s(t.activity.CONTENT)}})])]),e("div",{staticClass:"etcGrayButton",class:{etcRedButton:t.isActive},style:{marginBottom:this.$footBarHeight+"px"}},[e("div",{staticClass:"buttonGrayStyle",on:{click:function(i){return t.doAction()}}},[t._v(t._s(t.actionText))])]),e("van-action-sheet",{attrs:{round:!0,"safe-area-inset-bottom":!0,actions:t.selectActions,"cancel-text":"取消"},on:{select:t.onSelect,cancel:t.onCancel},model:{value:t.isShowSelect,callback:function(i){t.isShowSelect=i},expression:"isShowSelect"}}),e("van-popup",{style:{height:"36%"},attrs:{position:"bottom"},on:{"click-overlay":t.onNumCancel},model:{value:t.showJoinNum,callback:function(i){t.showJoinNum=i},expression:"showJoinNum"}},[e("van-picker",{attrs:{"show-toolbar":"",columns:t.joinNums,"default-index":t.curNumIndex,"confirm-button-text":"确定"},on:{change:t.onNumChange,cancel:t.onNumCancel,confirm:t.onNumOk}})],1)],1)},s=[],o=(e("c5f6"),e("a481"),e("0865")),a=e("2241"),c=e("0aa6"),r={name:"propertyActivityDetail",components:{NavigationBar:c["a"]},data:function(){return{detailParam:this.$route.query.object,activity:{},currentDetailData:{},LIMIT_MAX:0,ENROL_CNTS:0,ENROL_CNT:0,START_TIME:"",END_TIME:"",actionText:"",isActive:!1,isShowSelect:!1,sectionData:{},selectActions:[],isShowJoinInput:!1,joinNumber:null,showJoinNum:!1,curNumIndex:0,joinNums:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],headerItemWidth:{width:"84px"},title:"活动详情",bindThemeL:0!=this.$curTheme}},mounted:function(){this.userInfo=this.$userInfo,this.bindThemeL=0!=this.$curTheme,this.getActivityData()},methods:{getActivityData:function(){var t=this,i={ACTI_CODE:JSON.parse(this.detailParam).ACTI_CODE,OWNER_CODE:this.userInfo.OWNER_CODE,ROOM_CODE:this.userInfo.ROOM_CODE};Object(o["a"])({data:JSON.stringify(i)}).then((function(i){i&&(t.activity=i,t.activityStautsHandle())})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))},activityStautsHandle:function(){var t=(new Date).getTime();this.activity.START_TIME2=new Date(this.activity.START_TIME.replace(/-/g,"/")).getTime(),this.activity.END_TIME2=new Date(this.activity.END_TIME.replace(/-/g,"/")).getTime(),this.activity.END_TIME2<t?"0"!=this.activity.FLAG?(this.state=0,this.actionText="取消报名",this.getJoinInfo()):(this.state=1,this.actionText="报名",this.activityScreenings()):this.activity.START_TIME2<t&&this.activity.END_TIME2>t?"0"==this.activity.FLAG?(this.state=2,this.actionText="报名",this.isActive=!0,this.isShowJoinInput=!0,this.activityScreenings()):(this.state=3,this.actionText="取消报名",this.isActive=!0,this.getJoinInfo()):this.activity.START_TIME2>t&&(this.state=4,this.actionText="报名",this.activityScreenings())},getJoinInfo:function(){var t=this,i={ACTI_CODE:JSON.parse(this.detailParam).ACTI_CODE,OWNER_CODE:this.userInfo.OWNER_CODE,ROOM_CODE:this.userInfo.ROOM_CODE};Object(o["e"])({data:JSON.stringify(i)}).then((function(i){i?(console.log("00000000 getJoinInfoService = "+JSON.stringify(i)),t.currentDetailData=i,t.LIMIT_MAX=i.LIMIT_MAX,t.START_TIME=i.DETAIL_START_TIME,t.ENROL_CNT=i.ENROL_CNT,t.ENROL_CNTS=i.ENROL_CNTS,t.END_TIME=i.DETAIL_END_TIME,t.ENROL_CNTS?t.ENROL_CNTS=i.ENROL_CNT:t.ENROL_CNTS=0):console.log("getJoinInfoService: 没有获取到已报名场次信息。")})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))},activityScreenings:function(){var t=this,i={ACTI_CODE:JSON.parse(this.detailParam).ACTI_CODE};Object(o["g"])({data:JSON.stringify(i)}).then((function(i){if(i){console.log("22222222 getScreeningsService = "+JSON.stringify(i)),t.currentDetailData=i[0],t.sectionData=[];for(var e=0;e<i.length;e++){var n=i[e];t.selectActions.push({name:n.DETAIL_NAME,color:"#1f1f1f",ele:n})}t.getEtcIfo(i[0].DETAIL_CODE)}else console.log("activityScreenings: 没有获取到场次信息。")})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))},getEtcIfo:function(t){var i=this;console.log("call getEtcIfo");var e={DETAIL_CODE:t,OWNER_CODE:this.userInfo.OWNER_CODE,ROOM_CODE:this.userInfo.ROOM_CODE};Object(o["d"])({data:JSON.stringify(e)}).then((function(t){t?(console.log("33333333 getEtcDetailService = "+JSON.stringify(t)),i.LIMIT_MAX=t.LIMIT_MAX,i.START_TIME=t.START_TIME,i.ENROL_CNTS=t.ENROL_CNTS,i.END_TIME=t.END_TIME,i.ENROL_CNTS?i.ENROL_CNTS=t.ENROL_CNTS:i.ENROL_CNTS=0):console.log("getEtcIfo: 没有获取到场次信息。")})).catch((function(t){i.$toast("网络异常，请稍后重试！")}))},sectionSelectClicked:function(){0!=this.selectActions.length?this.currentDetailData.DETAIL_CODE&&(this.isShowSelect=!0):console.log("没有场次可选择")},onSelect:function(t){this.isShowSelect=!1,this.currentDetailData.DETAIL_CODE!=t.ele.DETAIL_CODE&&(this.currentDetailData=t.ele,this.getEtcIfo(t.ele.DETAIL_CODE))},onCancel:function(){},doAction:function(){var t="";0==this.state?(t="活动报名已结束，不能取消",this.$toast(t)):1==this.state?(t="活动报名已结束",this.$toast(t)):2==this.state?this.doAttendAction():4==this.state?(t="活动尚未开始",this.$toast(t)):this.doCancelAction()},doAttendAction:function(){var t=this,i=Number(this.joinNumber);i%1==0?i&&0!=i?a["a"].confirm({message:"确定报名？"}).then((function(){if(t.LIMIT_MAX){var e=t.ENROL_CNTS,n=i+e;n<=t.LIMIT_MAX?i<=t.activity.LIMIT_MAX?t.doAttend():t.$toast("超过家庭人数上限"):t.$toast("超过场次人数上限")}})).catch((function(t){console.log("捕获到错误",t)})):this.$toast("请填写正确的参与人数，必须为数字"):this.$toast("请输入正确的报名人数")},doAttend:function(){var t=this,i={DETAIL_CODE:this.currentDetailData.DETAIL_CODE,ROOM_CODE:this.userInfo.ROOM_CODE,ROOM_NAME:this.userInfo.ROOM_NAME,DETAIL_NAME:this.currentDetailData.DETAIL_NAME,ACTI_CODE:JSON.parse(this.detailParam).ACTI_CODE,ACTI_NAME:this.activity.ACTI_NAME,AREA_CODE:this.userInfo.AREA_CODE,AREA_NAME:this.userInfo.AREA_NAME,OWNER_CODE:this.userInfo.OWNER_CODE,OWNER_NAME:this.userInfo.OWNER_NAME,OWNER_NICK_NAME:this.userInfo.OWNER_NICK_NAME,PHONE:this.userInfo.PHONE,CITY_CODE:this.userInfo.CITY_CODE,DEPT_CODE:this.userInfo.DEPT_CODE,ENROL_CNT:Number(this.joinNumber),UPDATED_BY:this.userInfo.OWNER_NAME};console.log("stateFlag: "+JSON.stringify(i)),Object(o["f"])({data:JSON.stringify(i)}).then((function(i){1==i.success?(t.$toast("报名成功"),t.$router.back(-1)):t.$toast(i.msg?i.msg:"报名失败")}))},doCancelAction:function(){var t=this;a["a"].confirm({message:"确定取消报名？"}).then((function(){t.doCancel()})).catch((function(){}))},doCancel:function(){var t=this,i={DETAIL_CODE:this.currentDetailData.DETAIL_CODE,ACTI_CODE:JSON.parse(this.detailParam).ACTI_CODE,ACTI_NAME:this.activity.ACTI_NAME,OWNER_CODE:this.userInfo.OWNER_CODE,UPDATED_BY:this.userInfo.OWNER_NAME,AREA_CODE:this.userInfo.AREA_CODE,AREA_NAME:this.userInfo.AREA_NAME,CITY_CODE:this.userInfo.CITY_CODE,DEPT_CODE:this.userInfo.DEPT_CODE,OWNER_NAME:this.userInfo.OWNER_NAME,OWNER_NICK_NAME:this.userInfo.OWNER_NICK_NAME,PHONE:this.userInfo.PHONE,ROOM_CODE:this.userInfo.ROOM_CODE};Object(o["c"])({data:JSON.stringify(i)}).then((function(i){1==i.success?(t.$toast("取消报名成功"),t.$router.back(-1)):t.$toast("取消报名失败")}))},goBack:function(){this.$router.back(-1)},showJoinNums:function(){this.showJoinNum=!this.showJoinNum},onNumChange:function(t,i,e){this.curNumIndex=e},onNumCancel:function(){this.showJoinNum=!1},onNumOk:function(t,i){this.curNumIndex=i,this.showJoinNum=!1,this.joinNumber=this.joinNums[this.curNumIndex]}}},u=r,h=(e("21e2"),e("2877")),E=Object(h["a"])(u,n,s,!1,null,"01a66442",null);i["default"]=E.exports},f417:function(t,i,e){}}]);
//# sourceMappingURL=chunk-2ce39833.6376cc5d.js.map