(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29b85585"],{"0baf":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"system-message-page",class:{themeL:e.bindThemeL}},[n("navigation-bar",{attrs:{pageName:e.title,bothWidth:e.headerItemWidth},on:{onLeftClick:e.onBack},scopedSlots:e._u([{key:"nav-right",fn:function(){return[n("div",{staticClass:"rightBtn",on:{click:e.messageMarkRead}},[e._v(e._s(e.rightName))])]},proxy:!0}])}),n("div",{staticClass:"message-list"},[n("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.refreshing,callback:function(t){e.refreshing=t},expression:"refreshing"}},[n("van-list",{directives:[{name:"show",rawName:"v-show",value:!(e.contentLoaded&&0==e.messageList.length),expression:"!(contentLoaded && messageList.length == 0)"}],attrs:{error:e.error,"error-text":"请求失败，点击重新加载",finished:e.finished,offset:356,"immediate-check":!1},on:{"update:error":function(t){e.error=t},load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},e._l(e.messageList,(function(t,s){return n("div",{key:s,staticClass:"message-cell",on:{click:function(n){return e.jumpNoticeContent(t)}}},[n("div",{staticClass:"cell-icon"},[n("img",{attrs:{src:1!=t.READ_FLAG?e.noticeUnReadImg:e.noticeReadImg,alt:""}})]),n("div",{staticClass:"text-content",class:{textContentThemeL:e.bindThemeL}},[n("div",{staticClass:"text-title",style:1!=t.READ_FLAG?"color: #333333":"color: #C8C8C8"},[e._v(e._s(t.NOTICE_NAME))]),n("div",{staticClass:"message-time"},[e._v(e._s(t.CREATED_TIME))])]),n("div",{staticClass:"cell-right",class:{cellRightThemeL:e.bindThemeL}},[n("div",{staticClass:"testTmp",style:1!=t.READ_FLAG?"color: #333333":"color: #C8C8C8"},[e._v("查看详情")]),n("van-icon",{attrs:{name:"arrow",color:"#B0B0B0",size:"18px"}})],1)])})),0),n("div",{directives:[{name:"show",rawName:"v-show",value:e.contentLoaded&&0==e.messageList.length,expression:"contentLoaded && messageList.length == 0"}],staticClass:"no-list"},[n("img",{attrs:{src:e.noSourceImg,alt:""}}),n("div",{staticClass:"no-text"},[e._v("暂无消息")])])],1)],1),n("van-dialog",{attrs:{confirmButtonColor:"#fb5768",message:e.dialogMessage,"show-cancel-button":"",beforeClose:e.beforeClose},model:{value:e.isShowDialog,callback:function(t){e.isShowDialog=t},expression:"isShowDialog"}})],1)},i=[],o=(n("ac6a"),n("6b54"),n("35d6")),a=n("2b0e"),r=n("ad06"),c=n("2bdd"),h=n("58e6"),d=(n("5d2d"),n("0aa6")),u=n("18e4"),l=n.n(u),g=n("b93d"),f=n.n(g),m=n("d7a7"),O=n.n(m);a["a"].use(r["a"]).use(c["a"]).use(h["a"]);var E={name:"systemNotice",components:{NavigationBar:d["a"]},created:function(){this.getNoticeList(!0)},data:function(){return{active:0,title:"生活信箱",rightName:"",headerItemWidth:{width:"120PX"},messageList:[],refreshing:!1,loading:!1,finished:!1,error:!1,pageNum:1,pageSize:10,contentLoaded:!1,isShowDialog:!1,dialogMessage:"确认全部已读？",readedNotices:[],noSourceImg:l.a,noticeReadImg:f.a,noticeUnReadImg:O.a,bindThemeL:0!=this.$curTheme}},methods:{onBack:function(){this.$router.back(-1)},messageMarkRead:function(){0!=this.messageList.length&&(this.isShowDialog=!0)},beforeClose:function(e,t){"confirm"===e&&this.setMessageReaded(),t()},setMessageReaded:function(){var e=this,t={OWNER_CODE:this.$userInfo.OWNER_CODE,DEPT_CODE:this.$userInfo.DEPT_CODE,AREA_CODE:this.$userInfo.AREA_CODE,ROOM_CODE:this.$userInfo.ROOM_CODE};Object(o["c"])(t).then((function(t){e.showMsg(t.msg),document.querySelector(".message-list").scrollTop=0,e.onRefresh()})).catch((function(t){e.showMsg(t)}))},jumpNoticeContent:function(e){var t={UUID:e.UUID,NOTICE_CODE:e.NOTICE_CODE,DEPT_CODE:this.$userInfo.DEPT_CODE,ROOM_CODE:this.$userInfo.ROOM_CODE,OWNER_CODE:this.$userInfo.OWNER_CODE,AREA_CODE:this.$userInfo.AREA_CODE};this.$router.push({name:"noticeDetail",params:{noticeReq:t}})},getNoticeList:function(e){var t=this,n={OWNER_CODE:this.$userInfo.OWNER_CODE,AREA_CODE:this.$userInfo.AREA_CODE,DEPT_CODE:this.$userInfo.DEPT_CODE,ROOM_CODE:this.$userInfo.ROOM_CODE,PAGE:this.pageNum.toString(),ROWS:this.pageSize.toString()};Object(o["b"])(n).then((function(n){t.loading=!1,e&&(t.finished=!1,t.refreshing=!1,t.messageList=[]),void 0!=n.ROWS&&n.ROWS.length>0&&(n.ROWS.forEach((function(e){t.messageList.push(e)})),t.rightName="全部标为已读"),t.pageNum*t.pageSize>=n.TOTAL&&(t.finished=!0),t.pageNum++,t.contentLoaded=!0})).catch((function(e){t.loading=!1,t.refreshing=!1,t.error=!0,t.contentLoaded=!0,t.showMsg(e)}))},onLoad:function(){this.contentLoaded&&(this.error=!1,this.loading=!0,this.getNoticeList(!1))},onRefresh:function(){this.error=!1,this.loading=!1,this.pageNum=1,this.getNoticeList(!0)},showMsg:function(e){this.$toast(e)}}},C=E,p=(n("963c"),n("2877")),_=Object(p["a"])(C,s,i,!1,null,"ef5a165a",null);t["default"]=_.exports},"18e4":function(e,t,n){e.exports=n.p+"img/no_con_img.911db657.png"},"2b72":function(e,t,n){},"35d6":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var s=n("ba6a"),i=function(e){return new Promise((function(t,n){s["a"].post("hisense-systemServer/app/owner/notice/getAllNote.do",{data:JSON.stringify(e)},!0,"homeUrl").then((function(e){t(e)})).catch((function(e){n(e)}))}))},o=function(e){return new Promise((function(t,n){s["a"].post("hisense-systemServer/app/owner/notice/updateIgnore.do",{data:JSON.stringify(e)},!0,"homeUrl").then((function(e){t(e)})).catch((function(e){n(e)}))}))},a=function(e){return new Promise((function(t,n){s["a"].post("hisense-systemServer/app/owner/notice/getPropertyNotice.do",{data:JSON.stringify(e)},!0,"homeUrl").then((function(e){t(e)})).catch((function(e){n(e)}))}))}},"963c":function(e,t,n){"use strict";var s=n("2b72"),i=n.n(s);i.a},b93d:function(e,t,n){e.exports=n.p+"img/notice_read.2bf8b318.png"},d7a7:function(e,t,n){e.exports=n.p+"img/notice_unread.8fbb9da8.png"}}]);
//# sourceMappingURL=chunk-29b85585.d7b1a9ef.js.map