(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d59d8e3"],{"0865":function(t,i,e){"use strict";e.d(i,"b",(function(){return n})),e.d(i,"a",(function(){return r})),e.d(i,"d",(function(){return s})),e.d(i,"e",(function(){return o})),e.d(i,"c",(function(){return c})),e.d(i,"f",(function(){return l})),e.d(i,"g",(function(){return u}));var a=e("ba6a"),n=function(t){return new Promise((function(i,e){var n="xwj-property-activity/activity/getActiMsgByAreaCodeAndRoomCodeAndOwnerCode";a["a"].get(n,t,"baseUrl",!1).then((function(t){"0"==t.resultCode?i(t.data):e(t.msg)})).catch((function(t){e(t)}))}))},r=function(t){return new Promise((function(i,e){var n="xwj-property-activity/activity/getActiMsgByActiCodeAndRoomCode";a["a"].get(n,t,"baseUrl",!1).then((function(t){"0"==t.resultCode?i(t.data):e(t.msg)})).catch((function(t){e(t)}))}))},s=function(t){return new Promise((function(i,e){var n="xwj-property-activity/activity/getDetailMsgByDetailCodeAndRoomCode";a["a"].get(n,t,"baseUrl",!1).then((function(t){"0"==t.resultCode?i(t.data):e(t.msg)})).catch((function(t){e(t)}))}))},o=function(t){return new Promise((function(i,e){var n="xwj-property-activity/activity/getIsActiDetailMsgByActiCodeAndRoomCode";a["a"].get(n,t,"baseUrl",!1).then((function(t){"0"==t.resultCode?i(t.data):e(t.msg)})).catch((function(t){e(t)}))}))},c=function(t){var i="xwj-property-activity/activity/cancelEnrol";return new Promise((function(e,n){a["a"].post(i,t,!0,"baseUrl").then((function(t){e(t)})).catch((function(t){n(t)}))}))},l=function(t){var i="xwj-property-activity/activity/addActiEnrol";return new Promise((function(e,n){a["a"].post(i,t,!1,"baseUrl").then((function(t){e(t)})).catch((function(t){n(t)}))}))},u=function(t){return new Promise((function(i,e){var n="xwj-property-activity/activity/getDetailByActiCode";a["a"].get(n,t,"baseUrl",!1).then((function(t){"0"==t.resultCode?i(t.data):e(t.msg)})).catch((function(t){e(t)}))}))}},"39be":function(t,i,e){"use strict";var a=e("53d2"),n=e.n(a);n.a},"53d2":function(t,i,e){},"647a":function(t,i,e){t.exports=e.p+"img/defaultImg.f3fdc31a.png"},"64ce":function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"propertyActivity"},[a("navigation-bar",{attrs:{pageName:t.title,bothWidth:t.headerItemWidth},on:{onLeftClick:t.goBack}}),a("div",{staticClass:"scroll-content",style:{top:44+this.$stbHeight+"px"}},[a("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(i){t.refreshing=i},expression:"refreshing"}},[t.isShowEmpty?t._e():a("van-list",{attrs:{finished:t.finished,"immediate-check":!1,offset:600},on:{load:t.onLoad},model:{value:t.loading,callback:function(i){t.loading=i},expression:"loading"}},t._l(t.activity,(function(i){return a("van-cell",{key:i.ACTI_CODE,on:{click:function(e){return t.toDetail(i)}}},[a("div",{staticClass:"bgGray clearfix"},[a("div",{staticClass:"activity clearfix"},[a("div",{staticClass:"cardArea"},[a("div",{staticClass:"activityContent clearfix"},[a("div",{staticClass:"imgDrakArea"},[0==i.isImg?a("img",{staticClass:"full-image",attrs:{src:i.PIC_URL}}):t._e(),1==i.isImg?a("img",{staticClass:"full-image",attrs:{src:e("647a")}}):t._e(),a("div",{staticClass:"backDrap"},[i.START_TIME2>t.date1?a("span",{staticClass:"backText noStart"},[t._v("活动未开始")]):t._e(),i.END_TIME2<t.date1?a("span",{staticClass:"backText already"},[t._v("活动结束")]):t._e()])]),"1"==i.FLAG?a("div",{staticClass:"joinFlag"},[t._v("已报名")]):t._e(),a("div",{staticClass:"liveTitle"},[t._v(t._s(i.ACTI_NAME))]),a("div",{staticClass:"validDate colorAThree"},[t._v("\n                    活动时间\n                    "),a("i",{staticStyle:{visibility:"hidden"}},[t._v("1")]),t._v("\n                    "+t._s(t._f("limitMax")(i.START_TIME))+"\n                    "),a("i",{staticStyle:{visibility:"hidden"}},[t._v("1")]),t._v("至\n                    "),a("i",{staticStyle:{visibility:"hidden"}},[t._v("1")]),t._v("\n                    "+t._s(t._f("limitMax")(i.END_TIME))+"\n                    "),a("span",{staticStyle:{float:"right"}},[t._v(t._s(i.COUNTS)+"人报名")])])])])])])])})),1)],1)],1),t.isShowEmpty?a("div",{staticClass:"no-message"},[a("img",{attrs:{src:e("e88a")}}),a("p",[t._v("暂无活动")])]):t._e()],1)},n=[],r=(e("6b54"),e("a481"),e("c5f6"),e("0aa6")),s=e("0865"),o={name:"propertyActivityList",components:{NavigationBar:r["a"]},data:function(){return{total:0,isShowEmpty:!1,date1:"",activity:[],loading:!0,finished:!1,headerItemWidth:{width:"84px"},title:"物业活动",refreshing:!1}},mounted:function(){this.userInfo=this.$userInfo,this.query={page:"1",rows:"10",AREA_CODES:[{AREA_CODE:this.userInfo.AREA_CODE}],AREA_CODE:this.userInfo.AREA_CODE,OWNER_CODE:this.userInfo.OWNER_CODE,ROOM_CODE:this.userInfo.ROOM_CODE},this.onRefresh()},methods:{getActivityList:function(){var t=this;Object(s["b"])({data:JSON.stringify(this.query)}).then((function(i){t.total=i.TOTAL,t.date1=(new Date).getTime();var e=i.ROWS;t.total=i.TOTAL,0===t.total&&(t.isShowEmpty=!0),t.finished=i.ROWS.length>=t.total;for(var a=0;a<e.length;a++){var n=void 0,r=e[a].LIMIT_MAX,s=e[a].COUNTS;n=Math.round(Number(s)/Number(r)*1e4)/100,e[a].percent=n}for(var o=0;o<i.ROWS.length;o++)if(i.ROWS[o].PIC_URL){if(i.ROWS[o].isImg=0,o%2==0){var c=i.ROWS[o];c.PIC_URL=c.PIC_URL.replace("xwjfile.juhaolian.cn","xwjfilea.juhaolian.cn")}}else i.ROWS[o].isImg=1;t.activity=i.ROWS;for(var l=0;l<t.activity.length;l++)t.activity[l].START_TIME2=new Date(t.activity[l].START_TIME.replace(/-/g,"/")).getTime(),t.activity[l].END_TIME2=new Date(t.activity[l].END_TIME.replace(/-/g,"/")).getTime();t.loading=!1,t.refreshing=!1})).catch((function(i){t.$toast("网络异常，请稍后重试！"),t.refreshing=!1,t.loading=!1,t.isShowEmpty=!0}))},onRefresh:function(){this.query.page="1",this.getActivityList()},onLoad:function(){var t=this,i=Number(this.query.page),e=Number(this.query.rows),a=Number(this.total);if(i*e<a){var n=i+1;this.query.page=n.toString(),Object(s["b"])({data:JSON.stringify(this.query)}).then((function(i){t.loading=!1;for(var e=i.ROWS,a=0;a<i.ROWS.length;a++)if(i.ROWS[a].PIC_URL){if(i.ROWS[a].isImg=0,a%2==0){var n=i.ROWS[a];n.PIC_URL=n.PIC_URL.replace("xwjfile.juhaolian.cn","xwjfilea.juhaolian.cn")}}else i.ROWS[a].isImg=1;for(var r=0;r<e.length;r++){var s=void 0,o=e[r].LIMIT_MAX,c=e[r].COUNTS;s=Math.round(Number(c)/Number(o)*1e4)/100,e[r].percent=s}t.activity=t.activity.concat(i.ROWS);for(var l=0;l<t.activity.length;l++)t.activity[l].START_TIME2=new Date(t.activity[l].START_TIME.replace(/-/g,"/")).getTime(),t.activity[l].END_TIME2=new Date(t.activity[l].END_TIME.replace(/-/g,"/")).getTime();t.activity.length>=t.total&&(t.finished=!0)})).catch((function(i){t.$toast("网络异常，请稍后重试！"),t.loading=!1}))}else this.query={},this.loading=!1},toDetail:function(t){var i=this;this.date2=(new Date).getTime();var e={ACTI_CODE:t.ACTI_CODE,flag:1};setTimeout((function(){console.log("来啦"+i.date2),t.END_TIME2<i.date2?"0"!=t.FLAG?e.state=0:e.state=1:t.START_TIME2>i.date2?e.state=4:t.START_TIME2<i.date2&&t.END_TIME2>i.date2&&("0"==t.FLAG?e.state=2:e.state=3),i.$router.push({path:"/propertyActivityDetail",query:{object:JSON.stringify(e)}})}),350)},goBack:function(){this.$router.back(-1)}},filters:{limitMax:function(t){return t.substr(0,10)}}},c=o,l=(e("39be"),e("2877")),u=Object(l["a"])(c,a,n,!1,null,"61315be0",null);i["default"]=u.exports}}]);
//# sourceMappingURL=chunk-4d59d8e3.2020111114.js.map