(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f30e6ce"],{"0c95":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"visitorInvite"},[i("navigation-bar",{attrs:{pageName:t.title,bothWidth:t.headerItemWidth},on:{onLeftClick:t.onClickLeft}}),i("div",{staticClass:"visitorInviteContent"},[i("div",{staticClass:"visitorList"},[i("div",{staticClass:"inviteBtn",on:{click:function(e){return t.showDoors()}}},[t._v("我要邀请")])]),i("div",{staticClass:"visitorContent"},[t._m(0),i("van-list",{attrs:{finished:t.finished,"immediate-check":!1,offset:600},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.visitorData,(function(e,s){return i("div",{key:s,staticClass:"bgListContent"},[i("div",{staticClass:"intoHistory"},[i("div",{staticClass:"kindList"},[i("div",{staticClass:"intoLeft"},[t._v(t._s(e.VISITOR_NAME))]),1==e.TYPE?i("div",{staticClass:"timeRight"},[t._v("车辆进入")]):t._e(),2==e.TYPE?i("div",{staticClass:"timeRight"},[t._v("步行进入")]):t._e()]),i("div",{staticClass:"visitors"},[i("div",{staticClass:"visitorName"},[t._v(t._s(e.START_TIME))])])]),i("div",{staticClass:"baseLines"})])})),0)],1)]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.isShowShare,expression:"isShowShare"}],ref:"shareCover",attrs:{id:"shareCover"}},[i("div",{staticClass:"content"},[i("h4",[t._v("访客邀请二维码")]),i("div",{staticClass:"timeSpan"},[t._v("有效期至："+t._s(t.endTime))]),t._m(1),i("div",{staticClass:"img"},[i("div",{on:{click:function(e){return t.jumpToWeChat()}}},[i("div",{staticClass:"shareBtn"},[t._v("分享至微信")])])])]),i("div",{staticStyle:{width:"100%","text-align":"center"}},[i("img",{staticStyle:{"margin-top":"20px"},attrs:{src:t.visitor_btn_closed,alt:"",width:"35"},on:{click:function(e){return t.closeCover()}}})])]),i("van-popup",{style:{height:"36%"},attrs:{position:"bottom"},on:{"click-overlay":t.selectDoorCancel},model:{value:t.showDoorSelectView,callback:function(e){t.showDoorSelectView=e},expression:"showDoorSelectView"}},[i("div",{staticClass:"areaselect-topbar"},[i("div",{on:{click:t.selectDoorCancel}},[t._v("取消")]),i("span",{on:{click:t.selectDoorOk}},[t._v("确定")])]),i("van-picker",{attrs:{columns:t.doorName,"default-index":t.selectDoorIndex},on:{change:t.onChange}})],1)],1)},o=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bg"},[i("div",{staticClass:"bgList"},[i("h5",{staticClass:"inviteHistory"},[t._v("邀请记录")])])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{"text-align":"center"}},[i("canvas",{staticStyle:{height:"44px",width:"44px",margin:"0 auto"},attrs:{id:"phoneDoorQrcode"}})])}],n=i("bd86"),a=(i("ac6a"),i("ba6a")),r=function(t){return new Promise((function(e,i){a["a"].get("xwj-property-opendoor/access/getVistorList",t,!1,"homeUrl").then((function(t){e(t)})).catch((function(t){i(t)}))}))},c=function(t){return new Promise((function(e,i){a["a"].post("xwj-property-opendoor/access/getLingLingVisitorQrcode",t,!1).then((function(t){e(t)})).catch((function(t){i(t)}))}))},d=function(t){return new Promise((function(e,i){a["a"].post("xwj-llkm/phoneDoorMng/addOpenRecord",t,!0,"baseUrl").then((function(t){e(t)})).catch((function(t){i(t)}))}))},h=i("5bde"),l=i("d055"),v=i.n(l),u=i("0aa6"),f={name:"visitorInvite",components:{NavigationBar:u["a"]},data:function(){return{isHas:0,visitorData:[],visitorDefault:!1,endTime:"",total:0,visitorTotal:[],lingLingId:"",isShowShare:!1,showDoorSelectView:!1,doorName:[],selectDoorIndex:0,loading:!1,finished:!1,refreshing:!1,reqData:{OWNER_CODE:this.$userInfo.OWNER_CODE,AREA_CODE:this.$userInfo.AREA_CODE,pages:1,rows:"10"},headerItemWidth:{width:"84px"},title:"访客邀请",visitor_btn_closed:i("5865")}},mounted:function(){this.qrCanvas=document.getElementById("phoneDoorQrcode"),this.getVisitorList(),this.getDoorList()},methods:{showDoors:function(){this.doorName.length<=0?this.$toast("暂无可用门禁"):this.showDoorSelectView=!0},getVisitorList:function(){var t=this;this.reqData.page=this.reqData.pages+"",r({data:JSON.stringify(this.reqData)}).then((function(e){t.visitorDefault=!1,t.loading=!1,e.ROWS.length>0&&e.ROWS.forEach((function(e,i){t.visitorData.push(e)})),t.reqData.pages<e.TOTAL/10?t.finished=!1:t.finished=!0,t.reqData.pages++})).catch((function(e){t.loading=!1,t.finished=!0,t.$toast("网络异常，请稍后重试！")}))},onLoad:function(){this.getVisitorList()},getDoorList:function(){var t=this,e={NEIGH_NO:"",NEIGH_STRUCTURE:"",AREA_CODE:this.$userInfo.AREA_CODE,BUILD_CODE:this.$userInfo.BUILD_CODE,UNIT_CODE:this.$userInfo.UNIT_NO,ROOM_CODE:this.$userInfo.ROOM_CODE};Object(h["d"])({data:JSON.stringify(e)}).then((function(e){if(e.success){t.visitorTotal=e.doorInfos,t.lingLingId=e.lingLingId;for(var i=0;i<t.visitorTotal.length;i++)"令令"==t.visitorTotal[i].deviceMan&&2==(2&t.visitorTotal[i].openType)&&t.doorName.push(t.visitorTotal[i].deviceName)}else t.$toast(e.msg)})).catch((function(e){t.$toast("网络异常，请稍后重试！")}))},selectDoor:function(){this.showDoorSelectView=!0},selectDoorCancel:function(){this.showDoorSelectView=!1},selectDoorOk:function(){this.showDoorSelectView=!1,void 0!=this.selectDoorIndex&&this.getQrcode(this.visitorTotal[this.selectDoorIndex])},onChange:function(t,e,i){this.selectDoorIndex=i},closeCover:function(){this.isShowShare=!1},onClickLeft:function(){this.$router.back()},getEndTime:function(t){this.endTime=new Date(t+864e5);var e=this.endTime.getFullYear()+"年",i=this.endTime.getMonth()+1+"月",s=this.endTime.getDate()+"日",o=this.p(this.endTime.getHours()),n=this.p(this.endTime.getMinutes()),a=this.p(this.endTime.getSeconds());this.endTime=[e,i,s].join("")+[o,n,a].join(":")},p:function(t){return t<10?"0"+t:t},getQrcode:function(t){var e=this;this.deviceId=t.deviceId,this.deviceName=t.deviceName,this.qrcodeUrl="";var i=(new Date).getTime();this.getEndTime(i),console.log("测试"+this.endTime);var s=new Array;s.push(t.sdkKey);var o={lingLingId:this.lingLingId,sdkKeys:s,startTime:i,endTime:1440,effectNumber:0,strKey:"12345678"};c({data:JSON.stringify(o)}).then((function(t){t&&""!=t.qrcodeKey?(e.isShowShare=!0,v.a.toCanvas(e.qrCanvas,t.qrcodeKey)):e.$toast("获取二维码失败，请稍后重试！")})).catch((function(t){e.$toast("网络异常，请稍后重试！")}))},jumpToWeChat:function(){var t=this;this.addInvite(),this.addRecord(this.deviceId,this.deviceName,3,2,1,1,"访客邀请-微信");var e=this.qrCanvas.toDataURL("image/png");""!=e&&(Wechat.share({message:{title:"分享钥匙",description:"微信钥匙分享",media:{type:Wechat.Type.IMAGE,image:e}},scene:0},(function(){t.getVisitorList()}),(function(e){t.$toast(e)})),this.isShowShare=!1)},addInvite:function(){var t,e=device.model,i=device.platform,s=(t={OWNER_CODE:this.$userInfo.OWNER_CODE,AREA_CODE:this.$userInfo.AREA_CODE,AREA_NAME:this.$userInfo.AREA_NAME},Object(n["a"])(t,"OWNER_CODE",this.$userInfo.OWNER_CODE),Object(n["a"])(t,"OWNER_NAME",this.$userInfo.OWNER_NAME),Object(n["a"])(t,"OWNER_NICK_NAME",this.$userInfo.OWNER_NICK_NAME),Object(n["a"])(t,"PHONE",this.$userInfo.PHONE),Object(n["a"])(t,"ROOM_CODE",this.$userInfo.ROOM_CODE),Object(n["a"])(t,"ROOM_NAME",this.$userInfo.ROOM_NAME),Object(n["a"])(t,"OPEN_TYPE","3"),Object(n["a"])(t,"DEVICE_ID",this.deviceId),Object(n["a"])(t,"DEVICE_NAME",this.deviceName),Object(n["a"])(t,"PHONE_MODEL",e),Object(n["a"])(t,"PHONE_TYPE",i),t);d({data:JSON.stringify(s)}).then((function(t){t.success&&console.log("访客邀请记录成功!")}))},addRecord:function(t,e,i,s,o,n,a){var r=device.model,c=device.platform,d={areaCode:this.$userInfo.AREA_CODE,areaName:this.$userInfo.AREA_NAME,buildCode:this.$userInfo.BUILD_CODE,buildName:this.$userInfo.BUILD_NAME,unitNo:this.$userInfo.UNIT_NO,roomCode:this.$userInfo.ROOM_CODE,ownerCode:this.$userInfo.OWNER_CODE,ownerName:this.$userInfo.OWNER_NAME,ownerNickName:this.$userInfo.OWNER_NICK_NAME,phone:this.$userInfo.PHONE,phoneModel:r,phoneType:c,deviceId:t,deviceName:e,openType:i,deviceMan:s,doorType:o,validTime:1440,openSucceed:n,remarks:a};Object(h["b"])(d).then((function(t){"0"==t.resultCode&&console.log("访客邀请记录成功!")}))}}},O=f,E=(i("6ed0"),i("2877")),m=Object(E["a"])(O,s,o,!1,null,"4a1ea03c",null);e["default"]=m.exports},5865:function(t,e){t.exports="data:image/png;base64,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"},"6ed0":function(t,e,i){"use strict";var s=i("6ef5"),o=i.n(s);o.a},"6ef5":function(t,e,i){}}]);
//# sourceMappingURL=chunk-2f30e6ce.2020111114.js.map