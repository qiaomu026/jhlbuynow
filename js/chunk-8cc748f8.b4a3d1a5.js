(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8cc748f8"],{"1d92":function(t,e,n){t.exports=n.p+"img/image_finish@3x.40a629fe.png"},3367:function(t,e,n){"use strict";var i=n("ad3e"),s=n.n(i);s.a},5863:function(t,e,n){"use strict";n.d(e,"m",(function(){return s})),n.d(e,"n",(function(){return o})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return a})),n.d(e,"p",(function(){return u})),n.d(e,"i",(function(){return l})),n.d(e,"o",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"a",(function(){return m})),n.d(e,"s",(function(){return p})),n.d(e,"t",(function(){return g})),n.d(e,"r",(function(){return h})),n.d(e,"k",(function(){return v})),n.d(e,"q",(function(){return C})),n.d(e,"j",(function(){return w})),n.d(e,"g",(function(){return b})),n.d(e,"f",(function(){return y})),n.d(e,"h",(function(){return P})),n.d(e,"l",(function(){return T}));var i=n("ba6a"),s=function(t){return new Promise((function(e,n){i["a"].get("xwj-commerce-goods/goods/getGoodsInfoForApp",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},o=function(t){return new Promise((function(e,n){i["a"].get("xwj-commerce-shop/shopManage/getOneShopTitle",t,"baseUrl",!1).then((function(t){e(t)})).catch((function(t){n(t)}))}))},r=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/shopCart/addGoods",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},c=function(t){return new Promise((function(e,n){i["a"].post("xwj-sys-user/collect/saveCollect",t,!1,"baseUrl",!1).then((function(t){e(t)})).catch((function(t){n(t)}))}))},a=function(t){return new Promise((function(e,n){i["a"].post("xwj-sys-user/collect/deleteCollect",t,!1,"baseUrl",!1).then((function(t){e(t)})).catch((function(t){n(t)}))}))},u=function(t){return new Promise((function(e,n){i["a"].get("xwj-sys-user/collect/getCollectList",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},l=function(t){return new Promise((function(e,n){i["a"].get("xwj-commerce-sale/shopCart/getSkuTypeNum",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},h=function(t){return new Promise((function(e,n){i["a"].post("xwj-sys-user/share/shareGoods",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},f=function(t){return new Promise((function(e,n){i["a"].get("xwj-commerce-sale/shopCart/getGoodsList",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},d=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/shopCart/deleteGoods",t,!1).then((function(t){e(t)})).catch((function(t){n(t)}))}))},m=function(t){return new Promise((function(e,n){i["a"].post("xwj-sys-user/collect/saveCollectList",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},p=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/shopCart/updateGoodsNum",t,!1,"baseUrl",!1).then((function(t){e(t)})).catch((function(t){n(t)}))}))},g=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/shopCart/updateGoodsSelect",t,!1,"baseUrl",!1).then((function(t){e(t)})).catch((function(t){n(t)}))}))},v=function(t){return new Promise((function(e,n){i["a"].get("xwj-commerce-seckill/activitySpu/getActivityGoodsList",t,"baseUrl",!0).then((function(t){e(t)})).catch((function(t){n(t)}))}))},C=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-seckill/ownerNotice/subscribeSpuNotice ",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},w=function(t){return new Promise((function(e,n){i["a"].get("xwj-commerce-seckill/activitySpu/getActivityGoods",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},b=function(t){return new Promise((function(e,n){i["a"].get("xwj-advert-ssp/advertHtml/showGoods",t,"baseUrl",!0).then((function(t){e(t)})).catch((function(t){n(t)}))}))},y=function(t){return new Promise((function(e,n){i["a"].get("xwj-advert-ssp/advertHtml/queryAdvertPage",t,"baseUrl",!0).then((function(t){e(t)})).catch((function(t){n(t)}))}))},P=function(t){return new Promise((function(e,n){i["a"].post("xwj-sys-user/share/shareAdvertGoods",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},T=function(t){return new Promise((function(e,n){i["a"].post("xwj-sys-user/share/shareSeckill",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))}},a9ae:function(t,e,n){t.exports=n.p+"img/no_shop_con_img.7a6f8ec6.png"},ad3e:function(t,e,n){},d5b1:function(t,e,n){},f159:function(t,e,n){"use strict";var i=n("d5b1"),s=n.n(i);s.a},f884:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flashSaleList"},[n("navigation-bar",{staticClass:"title",style:t.setTopHeight,attrs:{pageName:"限时秒杀"},on:{onLeftClick:function(e){return t.goToBack()}}}),n("div",{staticClass:"tabTitle"},[n("van-tabs",{attrs:{"swipe-threshold":6,color:"#FB5768","line-width":"0.67rem","line-height":"0.08rem"},on:{click:t.controlTab},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabTitle,(function(e,i){return n("van-tab",{attrs:{title:e,name:i,"title-style":"1"==t.themeCurrent?{fontSize:"17px"}:{}}})})),1)],1),n("van-swipe",{ref:"swipe",staticClass:"orderSwipe",attrs:{"show-indicators":!1,loop:!1,"initial-swipe":t.firstTab},on:{change:t.controlSwiper}},[n("van-swipe-item",{key:0,on:{touchstart:function(e){return t.bottomAdTouchStart()},touchmove:function(e){return t.bottomAdTouchMove()},touchend:function(e){return t.bottomAdTouchEnd()}}},[n("div",{style:{height:"1px"}}),n("flashSaleCard",{ref:"mychild0",attrs:{mgChildKey:"1",isClickEven:t.swipeClickedEven,isActKey:t.active+1}})],1),n("van-swipe-item",{key:1,on:{touchstart:function(e){return t.bottomAdTouchStart()},touchmove:function(e){return t.bottomAdTouchMove()},touchend:function(e){return t.bottomAdTouchEnd()}}},[n("div",{style:{height:"1px"}}),n("flashSaleCard",{ref:"mychild1",attrs:{mgChildKey:"0",isClickEven:t.swipeClickedEven,isActKey:t.active-1}})],1),n("van-swipe-item",{key:2,on:{touchstart:function(e){return t.bottomAdTouchStart()},touchmove:function(e){return t.bottomAdTouchMove()},touchend:function(e){return t.bottomAdTouchEnd()}}},[n("div",{style:{height:"1px"}}),n("flashSaleCard",{ref:"mychild2",attrs:{mgChildKey:"2",isClickEven:t.swipeClickedEven,isActKey:t.active}})],1)],1)],1)},s=[],o=(n("7f7f"),n("bd86")),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flashSaleCard"},[n("van-pull-refresh",{on:{refresh:function(e){return t.onRefresh(t.mgChildKey)}},model:{value:t.isRefresh,callback:function(e){t.isRefresh=e},expression:"isRefresh"}},[n("van-list",{style:{"min-height":t.listMinHeight+"px"},attrs:{finished:t.finished,"immediate-check":!1},on:{load:function(e){return t.onLoad(t.mgChildKey)}},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.lists,(function(e,i){return 0==t.isLists?n("div",[n("div",{class:"1"==t.themeCurrent?"goodsCard-l":"goodsCard"},[n("div",{class:"1"==t.themeCurrent?"seckillPic-l":"seckillPic",on:{click:function(n){return t.turnToGoods(e)}}},[n("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.goodsPic,expression:"item.goodsPic"}]}),3==e.spuStatus||4==e.spuStatus?n("div",{staticClass:"noStock"},[t._v("补货中")]):t._e()]),n("div",{staticClass:"secKillInfo",on:{click:function(n){return t.turnToGoods(e)}}},[n("div",{class:"1"==t.themeCurrent?"secKillName-l":"secKillName"},[t._v("\n                "+t._s(e.spuName)+"\n            ")]),n("div",{class:"1"==t.themeCurrent?"salePoint-l":"salePoint"},[t._v("\n                "+t._s(e.salePoint)+"\n            ")]),n("div",{style:{clear:"both"}}),n("div",{staticClass:"salePrice"},[n("div",{class:"1"==t.themeCurrent?"secKillPrice-l":"secKillPrice"},[t._v("￥"+t._s(e.spuSkPrice))]),null!=e.originalPrice?n("div",{class:"1"==t.themeCurrent?"normalPrice-l":"normalPrice"},[t._v("￥"+t._s(e.originalPrice))]):t._e()]),"1"==t.mgChildKey?n("van-progress",{class:"1"==t.themeCurrent?"saleProgress-l":"saleProgress",attrs:{color:"linear-gradient(-135deg, #FF9BA5 0%, #FB5364 100%)","show-pivot":!1,percentage:3==e.spuStatus||4==e.spuStatus?100:e.salesPercent}}):t._e()],1),n("div",["0"==t.mgChildKey&&e.time>=3e5?n("div",{staticClass:"secKillStatus"},[n("div",{staticClass:"countDownTxt"},[t._v("距开始"),n("listCountDown",{style:{display:"inline-block"},attrs:{timeBox:e.time}})],1),n("button",{directives:[{name:"show",rawName:"v-show",value:0==e.isSubsribe,expression:"item.isSubsribe==0"}],class:"1"==t.themeCurrent?"remindMe-l":"remindMe",on:{click:function(n){return t.remindBefor(e,1)}}},[t._v("提醒我")]),n("button",{directives:[{name:"show",rawName:"v-show",value:1==e.isSubsribe,expression:"item.isSubsribe==1"}],class:"1"==t.themeCurrent?"remindCancle-l":"remindCancle",on:{click:function(n){return t.remindBefor(e,0)}}},[t._v("取消订阅")])]):t._e(),"0"==t.mgChildKey&&e.time<3e5?n("div",{staticClass:"secKillStatus"},[n("button",{staticClass:"countDownBtn"},[n("van-count-down",{style:{color:"#FF5050"},attrs:{"auto-start":!0,time:e.time},on:{finish:t.countDownFinish}})],1)]):t._e(),"1"==t.mgChildKey?n("div",{staticClass:"secKillStatus"},[n("div",{staticClass:"countDownTxt"},[t._v("距结束"),n("van-count-down",{style:{display:"contents"},attrs:{time:e.time},on:{finish:t.countDownFinish}})],1),n("button",{staticClass:"toBuy",style:{background:3==e.spuStatus||4==e.spuStatus?"#999999":"linear-gradient(143deg, #FF9BA5 0%, #FB5364 82%)"},on:{click:function(n){return t.turnToGoods(e)}}},[t._v("立即抢购")]),n("div",{class:"1"==t.themeCurrent?"salePercentage-l":"salePercentage"},[t._v("已抢购"+t._s(3==e.spuStatus||4==e.spuStatus?100:e.salesPercent)+"%")])]):t._e()]),"2"==t.mgChildKey?n("div",{staticClass:"secKillFinish"},[n("img",{attrs:{src:t.img.finished}})]):t._e()])]):t._e()})),1==t.isLists?n("div",{class:"1"==t.themeCurrent?"noList-l":"noList"},[n("img",{attrs:{src:t.img.noList}}),n("div",[t._v("暂无秒杀")])]):t._e(),t.ifNetWorkError?n("netWorkError"):t._e()],2)],1)],1)},c=[],a=n("5863"),u=(n("2f62"),n("2b0e")),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("van-count-down",{style:{display:"inline-block"},attrs:{"auto-start":!0,time:t.timeBox},on:{finish:t.countDownFinish}})],1)},h=[],f={name:"listCountdown",props:["timeBox"],data:{returun:{interValTime:null}},methods:{countDownFinish:function(){this.$parent.$parent.$parent.onRefresh(0)}},mounted:function(){var t=this,e=this.timeBox;this.interValTime=setInterval((function(){e-=1e3,3e5==e&&t.countDownFinish()}),1e3)},destroyed:function(){clearInterval(this.interValTime)}},d=f,m=n("2877"),p=Object(m["a"])(d,l,h,!1,null,"6d75c804",null),g=p.exports,v=n("dcbb"),C={name:"flashSaleCard",props:["mgChildKey","isActKey","isClickEven"],data:function(){return{lists:[],isLists:!1,isRefresh:!1,loading:!1,finished:!1,currentPage:1,totalPage:5,pageSize:5,ifNetWorkError:!1,img:{finished:n("1d92"),noList:n("a9ae")},listMinHeight:document.body.clientHeight-this.$stbHeight-65-44,themeCurrent:this.$curTheme}},components:{listCountDown:g,netWorkError:v["a"]},methods:{onLoad:function(t){console.log("mgChildKey"+this.mgChildKey+"isActKey"+this.isActKey),this.mgChildKey==this.isActKey&&(console.log(this.currentPage+"下拉刷新"),this.currentPage+=1,this.totalPage>=this.currentPage?(this.getLists(t),this.finished=this.currentPage>=this.totalPage):(this.totalPage<this.currentPage||0==this.lists.length)&&(console.log("总页数小于等于当前页数了"),this.finished=!0,this.loading=!1,this.isRefresh=!1))},onRefresh:function(t){this.currentPage=1,this.lists=[],this.getLists(t)},emptyData:function(){var t=[];t.push(this.lists[0]),this.lists=[]},getLists:function(t){var e=this,n={ownerCode:this.$userInfo.OWNER_CODE,areaCode:this.$userInfo.AREA_CODE,status:t,page:this.currentPage,rows:10};Object(a["k"])(n).then((function(t){e.totalPage=t.data.pages,e.ifNetWorkError=!1,e.isLists=0==t.data.records.length,0==t.data.total?(e.finished=!0,e.loading=!1,e.isRefresh=!1):(1==e.currentPage?e.lists=t.data.records:e.lists=e.lists.concat(t.data.records),e.lists.map((function(t,e){u["a"].prototype.$isHasLocalImage(t.goodsPic,(function(e){t.goodsPic=e}))})),e.getCountDown(e.mgChildKey),e.loading=!1,e.isRefresh=!1,e.finished=e.currentPage==t.data.pages,console.log("是否结束状态"+e.finished))})).catch((function(t){e.ifNetWorkError=!0,e.isLists=!1,e.isRefresh=!1,e.$toast("网络异常，请稍后重试！")}))},remindBefor:function(t,e){var n=this,i=this;if(i.isClickEven){var s={startTime:t.startTime,ownerCode:this.$userInfo.OWNER_CODE,activitySpuId:t.activitySpuId,subscribeFlag:e};Object(a["q"])(s).then((function(e){"0"==e.resultCode&&0==t.isSubsribe?(i.$toast("订阅成功"),i.onRefresh(n.mgChildKey)):"0"==e.resultCode&&1==t.isSubsribe?(i.$toast("取消订阅成功"),i.onRefresh(n.mgChildKey)):(i.$toast("订阅失败,请稍后重试!"),console.log("222222"))}))}},turnToGoods:function(t){this.isClickEven&&this.$router.push({path:"/flashSaleGoods",query:{spuCode:t.spuCode,activitySpuId:t.activitySpuId,goodsUrl:t.goodsPic}})},getCountDown:function(t){this.lists.map((function(e){if("0"==t){var n=e.startTime-e.nowTime;e.time=1e3*n}else if("1"==t){var i=e.endTime-e.nowTime;e.time=1e3*i}else e.time=0}))},countDownFinish:function(){this.onRefresh(this.mgChildKey)}}},w=C,b=(n("3367"),Object(m["a"])(w,r,c,!1,null,"5ba1476c",null)),y=b.exports,P=n("0aa6"),T={components:{flashSaleCard:y,NavigationBar:P["a"]},data:function(){var t;return t={tabTitle:["正在进行","即将开始","秒杀结束"],active:0,key:0,firstTab:0,setTopHeight:{"padding-top":this.$stbHeight+"px"},adClickFlag:!1,swipeClickedEven:!0},Object(o["a"])(t,"adClickFlag",!1),Object(o["a"])(t,"swipeClickedEven",!0),Object(o["a"])(t,"skuTypeNum",0),Object(o["a"])(t,"themeCurrent",this.$curTheme),t},filters:{setSkuTypeNum:function(t){return t>=100?"99+":t},threshold:function(t){return t>=1e4?((t+1e3)/1e4).toFixed(1)+"万+":t}},methods:{bottomAdTouchStart:function(){this.adClickFlag=!0},bottomAdTouchMove:function(){this.adClickFlag=!1},bottomAdTouchEnd:function(t){this.adClickFlag?this.swipeClickedEven=!0:this.swipeClickedEven=!1},controlTab:function(t){var e=this;e.key=t,e.$refs.swipe.swipeTo(t),window.scrollTo(0,0)},controlSwiper:function(t){this.active=t,0==t?(this.$refs.mychild0.onRefresh(1),this.$refs.mychild1.emptyData(),this.$refs.mychild2.emptyData()):1==t?(this.$refs.mychild1.onRefresh(0),this.$refs.mychild0.emptyData(),this.$refs.mychild2.emptyData()):(this.$refs.mychild1.emptyData(),this.$refs.mychild0.emptyData(),this.$refs.mychild2.onRefresh(2))},goToBack:function(){10==this.$route.query.flag?this.$route.push({path:"/productPage"}):this.$router.go(-1)},countDownFinish:function(){this.onRefresh(this.mgChildKey)},setTabIndex:function(t){this.$store.commit("leaveOrderList",{flashSaleTabIndex:t})}},goToShoppingCart:function(){this.$router.push({name:"shoppingCart",params:{}})},beforeRouteLeave:function(t,e,n){"flashSaleGoods"==t.name||"shoppingCart"==t.name||"flashSaleGoodsThemeL"==t.name?this.setTabIndex(this.active):this.setTabIndex(5),n()},mounted:function(){0==this.$route.params.firstTab||1==this.$route.params.firstTab?(this.firstTab=this.$route.params.firstTab,this.controlSwiper(this.firstTab)):(this.firstTab=this.flashSaleTabIndex,this.controlSwiper(this.firstTab))},computed:{flashSaleTabIndex:function(){return this.$store.state.productPage.flashSaleTabIndex}}},k=T,S=(n("f159"),Object(m["a"])(k,i,s,!1,null,"140a47d9",null));e["default"]=S.exports}}]);
//# sourceMappingURL=chunk-8cc748f8.b4a3d1a5.js.map