(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c87276f"],{"08ff":function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAHNJREFUSA1jYBgFoyEwGgKjITAaApSGACPIgIULFwqzsrKC2ZQaiEv/79+//8fHx79lnD179vb///974FJITXFGRsYdTEADaeozNAczgi2bN2+eKAsLC00t/vPnz/+kpKTXaA4Y5Y6GwGgIjIbAaAiQEQIAUioWkKGq9UQAAAAASUVORK5CYII="},"0d8a":function(t,i){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAAXNSR0IArs4c6QAAAQpJREFUSA3tVkEKgzAQNFVRwZu1byh9Sd/gRfBbguDFL7T4kNI3tPUmqKikWamSS0g2eChiQFx2Mzu7o1liGBorTdMbPBpQg2BBRVEc67p+A873/TCKog8mxwGzGfa2bbsUyduqedCEqolF+3ZCkTLa/l1SbelEwO1LOk2NPM8D27aXCSKSA/xN0wTjOD7BNk3z7HleBbZs9X1P4ziuCAxhSulVBlgjTgi5wzdU6mwNQuCayLIsCy3LUiLuui5gijygAFbxxXEcJUmHYaBJkryVSPjuoDgGfoGPFXmCJHxcZm//WOwdyv4BdHyXFC2ZDPD/krquS+cueHv2yd7oDn837ZIlLrG3bijmCy9TSTQY3o5rAAAAAElFTkSuQmCC"},2351:function(t,i,o){"use strict";var e=o("2ffb"),n=o.n(e);n.a},"2ffb":function(t,i,o){},"37b6":function(t,i,o){"use strict";o.r(i);var e=function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("div",{staticClass:"propertyPreOrderPay",class:{themeL:t.bindThemeL}},[o("navigation-bar",{attrs:{pageName:t.title,bothWidth:t.headerItemWidth},on:{onLeftClick:t.onClickLeft}}),o("div",{staticClass:"propertyPreOrderPayContent"},[o("div",{staticStyle:{"background-color":"#f2f2f2"}}),o("div",{staticClass:"list"},[o("div",{staticClass:"item",staticStyle:{border:"none"}},[o("div",{staticStyle:{display:"flex"}},[o("van-image",{attrs:{width:"54",height:"54",src:t.houseImg}}),o("div",{staticStyle:{left:"16px",flex:"1"}},[o("div",{staticStyle:{"min-height":"27px","line-height":"27px","font-size":"16px",color:"black"},style:{fontSize:t.roomNameFont}},[t._v(t._s(t.orderDetail.roomName))]),o("p",{staticStyle:{height:"27px","line-height":"27px","font-size":"12px",color:"#9a9a9a"},style:{fontSize:t.customerNameFont}},[t._v("房主："+t._s(t.orderDetail.customerName))])]),o("div")],1)]),o("div",{staticClass:"item"},[t._v("\n        预缴周期\n        "),o("span",{staticClass:"item-note",staticStyle:{color:"black"}},[o("span",[t._v(t._s(t.months))]),t._v("个月\n        ")])]),t._m(0),o("div",{staticClass:"item",staticStyle:{"padding-top":"0px",border:"none"}},t._l(t.cycleOptionList,(function(i,e){return o("div",{key:e,staticStyle:{"vertical-align":"center","margin-top":"16px",height:"20px",display:"flex"}},[o("div",{staticStyle:{display:"flex"}},[o("div",{staticStyle:{height:"20px"}},[t._v(t._s(i.payOptionName))]),i.discount<100?o("div",{staticClass:"saleTag"},[t._v(t._s(i.discount/10)+"折")]):t._e()]),o("div",{staticClass:"item-note",staticStyle:{height:"20px",display:"flex","justify-content":"flex-end","flex-grow":"1"}},[i.discount<100?o("div",{staticClass:"fs12",staticStyle:{height:"20px","margin-right":"4px","text-decoration":"line-through"}},[t._v("￥"+t._s(i.advanceMoney))]):t._e(),1==t.orderDetail.useDiscount?o("div",{staticClass:"fs16",staticStyle:{height:"20px",color:"black"}},[t._v("￥"+t._s(i.chargeMoney))]):t._e(),0==t.orderDetail.useDiscount?o("div",{staticClass:"fs16",staticStyle:{height:"20px",color:"black"}},[t._v("￥"+t._s(i.advanceMoney))]):t._e()])])})),0),t.noCycleOptionList.length>0?o("div",{staticClass:"item"},[o("div",{staticStyle:{color:"#9a9a9a"}},[t._v("非固定费用项")])]):t._e(),t.noCycleOptionList.length>0?o("div",{staticClass:"item",staticStyle:{"padding-top":"0px",border:"none"}},t._l(t.noCycleOptionList,(function(i,e){return o("div",{key:e,staticClass:"pt16"},[o("span",{staticStyle:{height:"22px"}},[t._v(t._s(i.payOptionName))]),o("span",{staticClass:"item-note",staticStyle:{color:"black"}},[t._v("￥"+t._s(i.chargeMoney))])])})),0):t._e(),o("div",{staticClass:"item"},[o("div",{staticStyle:{display:"flex"}},[o("div",{staticStyle:{width:"50%"}},[o("div",[o("p",{staticStyle:{color:"black","font-size":"16px"},style:{fontSize:t.pointFont}},[t._v("积分抵扣")]),o("p",{staticStyle:{color:"#9a9a9a","font-size":"12px"}},[t._v("100积分可抵1元")])])]),o("div",{staticStyle:{width:"50%"},attrs:{align:"right"}},[o("div",{staticClass:"change_point",staticStyle:{border:"1px solid","border-radius":"3px","border-color":"#bdbdbd","margin-top":"6px"}},[o("van-image",{staticClass:"delete_icon",attrs:{src:t.cutImg},on:{click:function(i){return t.pointReduce()}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.pointVO.deductionPoints,expression:"pointVO.deductionPoints"}],staticClass:"point_num",attrs:{type:"number"},domProps:{value:t.pointVO.deductionPoints},on:{input:function(i){i.target.composing||t.$set(t.pointVO,"deductionPoints",i.target.value)}}}),o("van-image",{staticClass:"add_icon",attrs:{src:t.addImg},on:{click:function(i){return t.pointAdd()}}})],1)])])]),o("div",{staticClass:"item",staticStyle:{display:"flex"}},[o("div",{on:{click:function(i){return t.integralInstructionFn()}}},[o("div",{staticStyle:{display:"flex"}},[o("p",{staticStyle:{color:"black","font-size":"16px",height:"20px"},style:{fontSize:t.pointFont}},[t._v("使用全部积分抵扣")]),o("p",{staticClass:"pointRule"},[t._v("?")])]),o("p",{staticStyle:{color:"#9a9a9a","font-size":"12px",height:"20px"}},[t._v("本次可用最高积分为"+t._s(t.pointAviable))])]),o("div",{staticClass:"item-note",staticStyle:{height:"31px",right:"0px","flex-grow":"1"}},[o("img",{staticClass:"choose_is_point",attrs:{src:t.isAllPoints?t.switchOnImg:t.switchOffImg},on:{click:function(i){return t.useAllPoints()}}})])]),o("div",{staticClass:"item",staticStyle:{"padding-bottom":"0px","font-size":"12px",color:"#3a3a3a"},style:{fontSize:t.pointFont}},[o("span",{staticClass:"btTitle"},[t._v("订单总额")]),o("span",{staticClass:"item-note",staticStyle:{color:"black"}},[t._v("￥"+t._s(t._f("keepTwoNum")(t.totalAmount)))])]),o("div",{staticClass:"item",staticStyle:{border:"none","padding-bottom":"0px","padding-top":"8px","font-size":"12px",color:"#3a3a3a"},style:{fontSize:t.pointFont}},[o("span",{staticClass:"btTitle"},[t._v("积分抵扣")]),o("span",{staticClass:"item-note",staticStyle:{color:"#fd666a"}},[t._v("-￥"+t._s(t._f("keepTwoNum")(t.pointVO.deductionMoney)))])]),t.discountMoney>0?o("div",{staticClass:"item",staticStyle:{"border-top":"none","padding-top":"8px","font-size":"12px",color:"#3a3a3a"},style:{fontSize:t.pointFont}},[o("span",{staticClass:"btTitle"},[t._v("折扣优惠")]),o("span",{staticClass:"item-note",staticStyle:{color:"#fd666a"}},[t._v("-￥"+t._s(t._f("keepTwoNum")(t.discountMoney)))])]):t._e()])]),o("div",{staticStyle:{height:"87px"}}),o("property-order-goto-pay",{attrs:{amount:t.unionPayMoney},on:{goToPay:t.goToPay}}),t.payWindowShow?o("property-pay-popup",{attrs:{payParam:t.payParam,isAlipay:t.isAlipay,isWechart:t.isWechart},on:{closePopup:t.closePopup,checkOrderStatus:t.checkOrderStatus}}):t._e()],1)},n=[function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("div",{staticClass:"item",staticStyle:{"padding-bottom":"0px","border-bottom":"none"}},[o("div",{staticStyle:{color:"#9a9a9a"}},[t._v("固定费用项")])])}],s=(o("7f7f"),o("22ae")),a=o("3ecb"),c=o("ba25"),l=o("0aa6"),d=o("2b0e"),r=o("2241");d["a"].use(r["a"]);var p={name:"propertyPreOrderPay",data:function(){return{billNo:"",orderDetail:{},isAllPoints:0,pointAviable:0,totalAmount:0,unionPayMoney:0,discountMoney:0,pointVO:{deductionPoints:0,deductionMoney:0},months:0,cycleOptionList:[],noCycleOptionList:[],payWindowShow:!1,isAlipay:!1,isWechart:!1,needRefresh:!0,headerItemWidth:{width:"84px"},title:"订单支付",switchOnImg:o("62e5"),switchOffImg:o("7e4b"),addImg:o("0d8a"),cutImg:o("08ff"),houseImg:o("64cc"),bindThemeL:0!=this.$curTheme,customerNameFont:0==this.$curTheme?"12px":"15px",roomNameFont:0==this.$curTheme?"16px":"18px",pointFont:0==this.$curTheme?"16px":"17px"}},components:{NavigationBar:l["a"],"property-order-goto-pay":a["a"],"property-pay-popup":c["a"]},beforeRouteLeave:function(t,i,o){"readTextPage"==t.name?this.needRefresh=!1:this.needRefresh=!0,o()},activated:function(){this.needRefresh&&(window.addEventListener("native.keyboardhide",this.pointValid),cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!1),this.cycleOptionList=[],this.noCycleOptionList=[],this.billNo=this.$route.params.billNo,this.pointVO.deductionPoints=0,this.pointVO.deductionMoney=0,this.isAllPoints=0,this.getPreOrderDetail())},methods:{getPreOrderDetail:function(){var t=this,i={billNo:this.billNo};Object(s["f"])(i).then((function(i){200==i.resultCode?(t.orderDetail=i.data,t.updateOptionList(i.data.detailList),t.totalAmount=parseFloat(i.data.payMoneyTotal).toFixed(2),t.unionPayMoney=parseFloat(i.data.unionPayMoney).toFixed(2),null!=i.data.deductionPoints&&""!=i.data.deductionPoints?(t.pointVO.deductionMoney=parseFloat(i.data.deductionMoney).toFixed(2),t.pointVO.deductionPoints=i.data.deductionPoints):t.pointVO.deductionPoints=0,t.months=i.data.months,t.getUseOrderLimitFn()):t.$toast(i.msg?i.msg:"网络异常，请稍后重试！")})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))},updateOptionList:function(t){for(var i=0;i<t.length;i++){0==t[i].feeType?this.cycleOptionList.push(t[i]):this.noCycleOptionList.push(t[i]);var o=this.discountMoney,e=t[i].discountMoney;this.discountMoney=o+e}},getUseOrderLimitFn:function(){var t=this,i={ownerCode:this.$userInfo.OWNER_CODE,money:this.totalAmount};Object(s["i"])(i).then((function(i){200==i.code?t.pointAviable=100*Math.floor(i.data/100):t.pointAviable=0})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))},pointAdd:function(){this.pointVO.deductionPoints+100>this.pointAviable?this.$toast("本单最高抵扣"+this.pointAviable+"积分"):(this.pointVO.deductionPoints+=100,this.pointVO.deductionMoney+=1,this.pointVO.deductionPoints==this.pointAviable&&(this.isAllPoints=1),this.calculateUnionPayMoney())},pointReduce:function(){this.isAllPoints=0,this.pointVO.deductionPoints<=0?this.$toast("抵扣积分不能为负数"):(this.pointVO.deductionPoints-=100,this.pointVO.deductionMoney-=1,this.calculateUnionPayMoney())},pointValid:function(){var t=this.pointVO.deductionPoints;if(isNaN(t))this.pointVO.deductionPoints=0;else{if(t>this.pointAviable)this.pointVO.deductionPoints=100*Math.floor(this.pointAviable/100),this.$toast("本单最高抵扣"+this.pointAviable+"积分");else if(t<0)this.pointVO.deductionPoints=0,this.$toast("抵扣积分不能为负数");else{var i=t;this.pointVO.deductionPoints=100*Math.floor(t/100),i!=this.pointVO.deductionPoints&&this.$toast("抵扣积分为整百")}console.log(this.pointVO.deductionPoints),this.pointVO.deductionMoney=this.pointVO.deductionPoints/100,this.calculateUnionPayMoney()}},integralInstructionFn:function(){this.$router.push({name:"readTextPage",params:{pageType:5}})},calculateUnionPayMoney:function(){this.unionPayMoney=parseFloat(this.totalAmount).toFixed(2)-parseFloat(this.discountMoney).toFixed(2)-parseFloat(this.pointVO.deductionMoney).toFixed(2),this.unionPayMoney=parseFloat(this.unionPayMoney).toFixed(2),console.log("【订单总额】this.unionPayMoney = "+this.unionPayMoney)},useAllPoints:function(){1==this.isAllPoints?this.isAllPoints=0:this.isAllPoints=1,1==this.isAllPoints?this.pointVO.deductionPoints=100*Math.floor(this.pointAviable/100):this.pointVO.deductionPoints=0,this.pointVO.deductionMoney=this.pointVO.deductionPoints/100,this.calculateUnionPayMoney()},onClickLeft:function(){window.removeEventListener("native.keyboardhide",this.pointValid),cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),this.$router.go(-2)},goToPay:function(){var t=this;if(this.unionPayMoney<0)this.$toast("订单生成错误，金额不能为负数");else{var i={billNo:this.billNo,deductionPoints:this.pointVO.deductionPoints,deductionMoney:this.pointVO.deductionMoney,unionPayMoney:this.unionPayMoney};Object(s["m"])(i).then((function(i){200==i.resultCode?(t.payParam=i.data,"1"==i.data.IS_ALI_PAY&&(t.isAlipay=!0),"1"==i.data.IS_WX_PAY&&(t.isWechart=!0),t.payWindowShow=!0,window.broadcaster.addEventListener("paymentBack",t.payCallBack)):t.$toast(i.msg?i.msg:"网络异常，请稍后重试！")})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))}},payCallBack:function(){this.checkOrderStatus()},checkOrderStatus:function(){var t=this;window.broadcaster.removeEventListener("paymentBack",this.payCallBack);var i={billNo:this.billNo};Object(s["f"])(i).then((function(i){200==i.resultCode?1==i.data.billStatus?t.$router.push({name:"paymentPaySuccess",params:{orderData:i.data}}):t.$toast({duration:500,message:"支付失败",onClose:function(){t.$router.go(-2)}}):t.$toast(i.msg?i.msg:"网络异常，请稍后重试！")})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))},closePopup:function(){this.payWindowShow=!1}}},u=p,h=(o("2351"),o("2877")),y=Object(h["a"])(u,e,n,!1,null,"cc62934a",null);i["default"]=y.exports}}]);
//# sourceMappingURL=chunk-1c87276f.5a2cc291.js.map