(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cc0ff484"],{"12e3":function(t,e,n){t.exports=n.p+"img/bg_coupon_used.2de2ae70.png"},2736:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAMCAYAAABm+U3GAAAAAXNSR0IArs4c6QAAAQ5JREFUOBGdkdtOwkAURVvBAOUS/QN+iw8zMeGBxERRDMgTUIw0ioGY+Dc+8jCuTeYkttJS2Mnqmc7ZZ/cyQVBCzrk2rGAD1yVGjlsIasEnmL5ZXB2fLHAQ0IS1T3yg3vj1F7VTMJrfYlCh7z7okVqBEG793pbazk840GEgggSkJ6iYjbXC+yDpF7WsV1gxNuANpBFUswPsKXwA0gc0s57UPQaFvoL0DP9CbYDeBdyBlEBkvVSlUYcYpDHkhtogHoXfg6SvbFhvX9mowQKkCVymDAU3eHWoOlxpCfW/obP9tnMv1NKh9jxmqqBfJ82hFnDRG0pTODk0E25ZE51uTPMHemEY7sx4TvUvNmS2+wvUoFm5yP6K7gAAAABJRU5ErkJggg=="},"47a3":function(t,e,n){"use strict";var i=n("f16d"),o=n.n(i);o.a},"6c90":function(t,e,n){"use strict";n.d(e,"i",(function(){return o})),n.d(e,"k",(function(){return s})),n.d(e,"g",(function(){return c})),n.d(e,"h",(function(){return a})),n.d(e,"j",(function(){return r})),n.d(e,"f",(function(){return u})),n.d(e,"a",(function(){return d})),n.d(e,"l",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"c",(function(){return m})),n.d(e,"b",(function(){return f})),n.d(e,"d",(function(){return p}));var i=n("ba6a"),o=function(t){return new Promise((function(e,n){i["a"].get("xwj-commerce-sale/myOrder/getAllOrders",t,"baseUrl",!0).then((function(t){e(t)})).catch((function(t){n(t)}))}))},s=function(t){return new Promise((function(e,n){i["a"].get("xwj-commerce-sale/myOrder/getUnevaluatedSaleOrders",t,"baseUrl",!0).then((function(t){e(t)})).catch((function(t){n(t)}))}))},c=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/myOrder/confirmOrder",t,!1).then((function(t){e(t)})).catch((function(t){n(t)}))}))},a=function(t){return new Promise((function(e,n){i["a"].get("xwj-commerce-sale/goods/returnOrderList",t,"baseUrl",!1).then((function(t){e(t)})).catch((function(t){n(t)}))}))},r=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-coupon/coupon/queryByUser",t,!1,"baseUrl",!1).then((function(t){e(t)})).catch((function(t){n(t)}))}))},u=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/order/orderCancel",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},l=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/order/prepareToPayOrder",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},d=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/shopCart/batchAddGoods",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},f=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/goods/validateReturnGoods",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},h=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/goods/returnGoodsCancel",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},m=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/goods/returnGoods",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))},p=function(t){return new Promise((function(e,n){i["a"].post("xwj-commerce-sale/goods/refundBySub",t).then((function(t){e(t)})).catch((function(t){n(t)}))}))}},"83c4":function(t,e,n){t.exports=n.p+"img/bg_coupon_expired.9b8dcd64.png"},"8c6a":function(t,e,n){t.exports=n.p+"img/no_coupon_img.a94be2ee.png"},"9ae6":function(t,e,n){},"9fe5":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"myOrderList"},[n("navigation-bar",{staticClass:"title",style:t.setTopHeight,attrs:{pageName:"我的优惠券"},on:{onLeftClick:function(e){return t.goToBack()}}}),n("div",{staticClass:"tabTitle",class:{themeL:t.bindThemeL}},[n("van-tabs",{attrs:{color:"#FB5768","line-width":"0.67rem","line-height":"0.08rem"},on:{click:t.controlTab},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.tabTitle,(function(t,e){return n("van-tab",{key:e,attrs:{title:t}})})),1)],1),n("van-swipe",{ref:"swipe",staticClass:"orderSwipe",attrs:{"show-indicators":!1,"initial-swipe":0,loop:!1},on:{change:t.controlSwipe}},[n("van-swipe-item",{key:0},[n("couponCard",{ref:"mychild0",attrs:{mgChildKey:"01",isActKey:"0"+(t.active+1)}})],1),n("van-swipe-item",{key:1},[n("couponCard",{ref:"mychild1",attrs:{mgChildKey:"02",isActKey:"0"+(t.active+1)}})],1),n("van-swipe-item",{key:2},[n("couponCard",{ref:"mychild2",attrs:{mgChildKey:"03",isActKey:"0"+(t.active+1)}})],1)],1)],1)},o=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"couponcard"},[n("van-pull-refresh",{on:{refresh:function(e){return t.onRefresh(t.mgChildKey)}},model:{value:t.isRefresh,callback:function(e){t.isRefresh=e},expression:"isRefresh"}},[n("van-list",{style:{"min-height":t.listMinHeight+"px"},attrs:{finished:t.finished,"error-text":"请求失败，刷新重新加载","loading-text":"","immediate-check":!1},on:{load:function(e){return t.onLoad(t.mgChildKey)}},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[t._l(t.lists,(function(e,i){return 0==t.isLists?n("div",{staticClass:"commonCard"},[n("div",{staticClass:"backPic",style:{backgroundImage:"url("+("01"==t.mgChildKey?t.img.waitUsed:"02"==t.mgChildKey?t.img.alreadyUsed:t.img.outDate)+")"}},[n("div",{staticClass:"leftPoint"},[n("div",{staticClass:"couponDetail"},[n("div",[t._v("￥")]),n("div",{staticClass:"couponTotal"},[t._v(t._s(e.couponTotal))])]),n("div",{staticClass:"scopeType",on:{click:function(e){return t.showScope(i)}}},[n("span",[t._v("适用范围")]),n("img",{attrs:{src:0==e.ifShowScope?t.img.filterDown:t.img.filterUp}})])]),n("div",{staticClass:"rightPoint"},[n("div",{staticClass:"shopName"},[t._v(t._s(e.shopName))]),n("div",{staticClass:"couponLimit"},[t._v(t._s(e.name))]),n("div",{staticClass:"toUse"},[n("div",{staticClass:"useDate"},[t._v(t._s(e.effBeginDay)+"-"+t._s(e.effEndDay))]),"01"==t.mgChildKey?n("div",{staticClass:"toUsebtn",on:{click:function(n){return t.useCoupon(e.shopCode)}}},[t._v("去使用")]):t._e()])])]),1==e.ifShowScope?n("div",{staticClass:"scopeInfo"},[t._v("全品类通用")]):t._e()]):t._e()})),1==t.isLists?n("div",{staticClass:"noList",class:{noListThemeL:t.bindThemeL}},[n("img",{attrs:{src:t.img.noList}}),n("div",[t._v("暂无优惠券")])]):t._e()],2)],1)],1)},c=[],a=n("6c90"),r=(n("2f62"),{name:"couponCard",props:["mgChildKey","isActKey"],data:function(){return{lists:[],page:1,totalPages:5,loading:!1,finished:!1,isLists:!1,scopeType:[],isRefresh:!1,img:{waitUsed:n("e1ad"),alreadyUsed:n("12e3"),outDate:n("83c4"),filterDown:n("cb1c"),filterUp:n("2736"),noList:n("8c6a")},listMinHeight:document.body.clientHeight-this.$stbHeight-118,bindThemeL:0!=this.$curTheme}},methods:{getCouponList:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;console.log("当前页数"+n.page+"当前列表"+n.mgChildKey);var i={page:n.page,rows:10,ownerCode:n.$userInfo.OWNER_CODE,status:n.mgChildKey};Object(a["j"])(i).then((function(t){n.totalPages=t.pages,console.log("没有请求数据吗"),t.data.couponScopeList.map((function(t){t.ifShowScope=!1})),0==t.total?(n.isLists=!0,n.finished=!0,n.loading=!1,n.isRefresh=!1):(n.lists=e?t.data.couponScopeList:n.lists.concat(t.data.couponScopeList),n.loading=!1,n.isLists=!1,n.isRefresh=!1,console.log("是否结束"+n.finished))}))},showScope:function(t){var e=this;console.log(t);var n=e.lists[t].ifShowScope;e.lists[t].ifShowScope=!n},emptyData:function(){var t=[];t.push(this.lists[0]),this.lists=[]},onLoad:function(t){console.log("onLoad加载数据！");var e=this;e.mgChildKey==e.isActKey&&(e.page+=1,e.totalPages>=e.page?(e.getCouponList(t,!1),e.finished=e.page>e.totalPages):(e.totalPages<e.page||""!=e.lists)&&(console.log("总页数小于等于当前页数了"),e.loading=!1,e.isRefresh=!1))},onRefresh:function(t){this.page=1,this.getCouponList(t,!0)},useCoupon:function(t){this.$router.push({name:"shopPage",params:{shopCode:t}})}}}),u=r,l=(n("a52d"),n("2877")),d=Object(l["a"])(u,s,c,!1,null,"4403a9e6",null),f=d.exports,h=n("0aa6"),m={data:function(){return{tabTitle:["待使用","已使用","已过期"],active:0,key:0,isPushLoading:!1,setTopHeight:{"padding-top":this.$stbHeight+"px"},bindThemeL:0!=this.$curTheme}},components:{couponCard:f,NavigationBar:h["a"]},methods:{controlTab:function(t){var e=this;e.key=t,e.$refs.swipe.swipeTo(t),window.scrollTo(0,0)},controlSwipe:function(t){var e=this;e.active=t,"0"==t?(this.$refs.mychild0.onRefresh("1"),this.$refs.mychild1.emptyData(),this.$refs.mychild2.emptyData()):"1"==t?(this.$refs.mychild1.onRefresh("2"),this.$refs.mychild0.emptyData(),this.$refs.mychild2.emptyData()):(this.$refs.mychild2.onRefresh("3"),this.$refs.mychild1.emptyData(),this.$refs.mychild0.emptyData())},goToBack:function(){this.$router.go(-1)}},mounted:function(){this.controlSwipe("0")}},p=m,g=(n("47a3"),Object(l["a"])(p,i,o,!1,null,"0c3e218f",null));e["default"]=g.exports},a52d:function(t,e,n){"use strict";var i=n("9ae6"),o=n.n(i);o.a},cb1c:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAMCAYAAABm+U3GAAAAAXNSR0IArs4c6QAAAQVJREFUOBGlkd1KAlEURuc0U47zQ/l4PZggdBEEalka3lgpJZUgwjyE7+HFaX1juwtRmcYPFvuc2Wev+XPe+yIIgjVcO+c21NrBdcFwD/KAzQgU1aiuldlzGIMykrgBL9qRR/i3nBlJn0GZQKN8QBYxTEG5h7Dqk3NWUnvrV9ZbqQm40IR3ULpwZr1DlTMRDEF5g3jvWRoJzEG5g4NyepI+gTKD/VK7EwdS+ALlFpz1rHJN0gEoesum9Y5WDmawAOUG/uSsQ3gAZQ7JUdluk4EclqB0wIGk+rnKJ6S7c5X2DF7CCpQ29MuV99/UelK7M4IrKH6FKvpEmfVPqohaoM/yAXkV2Q+jmVmqKd7MGwAAAABJRU5ErkJggg=="},e1ad:function(t,e,n){t.exports=n.p+"img/mall_bg_coupon_unaccalimed.23297250.png"},f16d:function(t,e,n){}}]);
//# sourceMappingURL=chunk-cc0ff484.23ad4160.js.map