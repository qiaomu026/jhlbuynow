(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-dd1ae948"],{"48ae":function(t,i,e){},ad07:function(t,i,e){"use strict";e.r(i);var a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"propertyOrderPay",class:{themeL:t.bindThemeL}},[e("navigation-bar",{attrs:{pageName:t.title,bothWidth:t.headerItemWidth},on:{onLeftClick:t.onClickLeft}}),e("div",{staticClass:"propertyOrderPayContent"},[e("van-swipe",{attrs:{"indicator-color":"white","show-indicators":!1}},t._l(t.orderDetial.roomList,(function(i,a){return e("van-swipe-item",{key:a},[e("div",{staticClass:"user_info"},[e("van-image",{staticClass:"user_img",attrs:{src:t.houseImg}}),e("div",{staticClass:"user_word"},[e("div",{staticClass:"user_home"},[t._v(t._s(i.room_name))]),e("div",{staticClass:"user_name"},[t._v("房主："+t._s(i.owner_name))])])],1),e("div",{staticClass:"order_itme_list"},t._l(i.monthList,(function(i,o){return e("div",{key:o},[e("div",{staticStyle:{display:"flex",height:"60px","line-height":"60px","border-bottom":"1px solid #ececec",margin:"0 5%"},on:{click:function(i){return t.showTime(a,o)}}},[e("div",{staticStyle:{width:"50%","font-size":"14px"},style:{fontSize:t.itemFont}},[t._v(t._s(i.month_name))]),e("div",{staticStyle:{width:"50%","text-align":"right","font-size":"14px"},style:{fontSize:t.itemFont}},[t._v("￥"+t._s(t._f("keepTwoNum")(i.month_amount)))]),e("van-image",{staticStyle:{"margin-top":"23px"},attrs:{width:"14",height:"14",src:i.isShow?t.arrowDownImg:t.arrowRightImg}})],1),i.isShow?e("div",{staticStyle:{"padding-bottom":"16px",background:"#f7f7f7"}},t._l(i.billDetailList,(function(i,a){return e("div",{key:a,staticClass:"freeShow"},[e("div",{staticClass:"freeText"},[t._v(t._s(i.payment_type))]),e("div",{staticClass:"freeText"},[t._v("￥"+t._s(i.payment_amount))])])})),0):t._e()])})),0)])})),1),e("div",{staticClass:"pointDeduction"},[e("div",{staticClass:"change_point"},[e("img",{staticClass:"delete_icon",attrs:{src:t.cutImg},on:{click:function(i){return t.numberReduce(t.pointAviable)}}}),e("input",{directives:[{name:"model",rawName:"v-model",value:t.integralDeduction,expression:"integralDeduction"}],staticClass:"point_num",attrs:{type:"number"},domProps:{value:t.integralDeduction},on:{input:function(i){i.target.composing||(t.integralDeduction=i.target.value)}}}),e("img",{staticClass:"add_icon",attrs:{src:t.addImg},on:{click:function(i){return t.numberAdd(t.pointAviable)}}})]),t._m(0)]),e("div",{staticClass:"line"}),e("div",{staticClass:"pointDeduction"},[e("van-image",{staticClass:"choose_is_point",attrs:{src:t.integralAll?t.switchOnImg:t.switchOffImg},on:{click:function(i){return t.integralAllFn(t.pointAviable)}}}),e("div",{staticClass:"point_info"},[e("div",{staticClass:"point_title"},[e("span",[t._v("使用全部积分抵扣")]),e("div",{staticStyle:{width:"25px","margin-top":"-3px"},on:{click:function(i){return t.integralInstructionFn()}}},[e("van-image",{attrs:{src:t.tipsImg}})],1)]),e("div",{staticClass:"point_rule"},[t._v("本次可用最高积分为"+t._s(t.pointAviable))])])],1),e("div",{staticClass:"line"}),e("div",{staticClass:"total_and_deduction"},[e("div",{staticClass:"total_money"},[e("div",{staticClass:"total_name"},[t._v("订单总额")]),e("div",{staticClass:"total_num"},[t._v("￥"+t._s(t._f("keepTwoNum")(t.bill_amount)))])]),e("div",{staticClass:"deduction_point"},[e("div",{staticClass:"deduction_name"},[t._v("积分抵扣")]),e("div",{staticClass:"deduction_num"},[t._v("-￥"+t._s(t._f("keepTwoNum")(t.pointAviablePersent)))])])])],1),e("div",{staticStyle:{height:"87px"}}),e("property-order-goto-pay",{attrs:{amount:t.billCodePoint},on:{goToPay:t.goToPay}}),t.payWindowShow?e("property-pay-popup",{attrs:{payParam:t.payParam,isAlipay:t.isAlipay,isWechart:t.isWechart},on:{closePopup:t.closePopup,checkOrderStatus:t.checkOrderStatus}}):t._e()],1)},o=[function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"point_info"},[e("div",{staticClass:"point_title"},[t._v("积分抵扣")]),e("div",{staticClass:"point_rule"},[t._v("100积分抵扣1元")])])}],s=(e("7f7f"),e("22ae")),n=e("3ecb"),r=e("ba25"),l=e("0aa6"),c=e("2b0e"),d=e("2241");c["a"].use(d["a"]);var h={name:"propertyOrderPay",data:function(){return{billNo:"",areaCode:"",bill_amount:0,billCodePoint:0,pointAviablePersent:0,pointAviable:0,integralAll:!1,integralDeduction:0,orderDetial:{},payWindowShow:!1,isAlipay:!1,isWechart:!1,needRefresh:!0,headerItemWidth:{width:"84px"},title:"订单支付",switchOnImg:e("62e5"),switchOffImg:e("7e4b"),houseImg:e("64cc"),addImg:e("8b50"),cutImg:e("a366"),tipsImg:e("6d99"),arrowRightImg:e("67bc"),arrowDownImg:e("e1fa"),bindThemeL:0!=this.$curTheme,itemFont:0==this.$curTheme?"14px":"17px"}},components:{NavigationBar:l["a"],"property-order-goto-pay":n["a"],"property-pay-popup":r["a"]},mounted:function(){},beforeRouteLeave:function(t,i,e){"readTextPage"==t.name?this.needRefresh=!1:this.needRefresh=!0,e()},activated:function(){this.needRefresh&&(window.addEventListener("native.keyboardhide",this.pointValid),cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!1),this.billNo=this.$route.params.billCode,this.areaCode=this.$route.params.areaCode,this.integralDeduction=0,this.pointAviablePersent=0,this.integralAll=!1,this.queryOrderDetail())},methods:{queryOrderDetail:function(){var t=this,i={bill_code:this.billNo};Object(s["q"])({data:JSON.stringify(i)}).then((function(i){if(i.result){for(var e in i.data.roomList)for(var a in i.data.roomList[e].monthList)i.data.roomList[e].monthList[a].isShow=!1;t.orderDetial=i.data,t.bill_amount=i.data.bill_amount,t.billCodePoint=i.data.bill_amount,t.getUseLimit()}else t.$toast("网络异常，请稍后重试！")})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))},getUseLimit:function(){var t=this,i={ownerCode:this.$userInfo.OWNER_CODE,money:this.billCodePoint};Object(s["i"])(i).then((function(i){200==i.code?t.pointAviable=100*Math.floor(i.data/100):t.pointAviable=0})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))},queryBillDetail:function(t,i){var e=this,a={bill_no:this.billNo,room_code:this.orderDetial.roomList[t].room_code,month_code:this.orderDetial.roomList[t].monthList[i].month_code};Object(s["r"])({data:JSON.stringify(a)}).then((function(a){a.result&&a.data.billDetailList?(e.orderDetial.roomList[t].monthList[i].billDetailList=a.data.billDetailList,e.orderDetial.roomList[t].monthList[i].isShow=!e.orderDetial.roomList[t].monthList[i].isShow):e.$toast(a.msg?a.msg:"网络异常，请稍后重试！")})).catch((function(t){e.$toast("网络异常，请稍后重试！")}))},showTime:function(t,i){null==this.orderDetial.roomList[t].monthList[i].billDetailList||"undefined"==this.orderDetial.roomList[t].monthList[i].billDetailList?this.queryBillDetail(t,i):this.orderDetial.roomList[t].monthList[i].isShow=!this.orderDetial.roomList[t].monthList[i].isShow},integralAllFn:function(t){this.integralAll=!this.integralAll,this.integralAll?this.integralDeduction=100*Math.floor(t/100):this.integralDeduction=0,this.pointAviablePersent=(this.integralDeduction/100).toFixed(2),this.billCodePoint=(parseFloat(this.bill_amount)-parseFloat(this.pointAviablePersent)).toFixed(2)},numberAdd:function(t){this.integralDeduction<t&&this.integralDeduction+100<=t?this.integralDeduction=this.integralDeduction+100:this.$toast("本次可用最高积分为"+this.integralDeduction),this.pointAviablePersent=(this.integralDeduction/100).toFixed(2),this.billCodePoint=(parseFloat(this.bill_amount)-parseFloat(this.pointAviablePersent)).toFixed(2)},numberReduce:function(){this.integralAll=!1,0!=this.integralDeduction?(this.integralDeduction-100<0?this.integralDeduction=0:this.integralDeduction=this.integralDeduction-100,this.pointAviablePersent=(this.integralDeduction/100).toFixed(2),this.billCodePoint=(parseFloat(this.bill_amount)-parseFloat(this.pointAviablePersent)).toFixed(2)):this.$toast("已经是最低了，不能在减少了哦！")},pointValid:function(){var t=this.integralDeduction;if(isNaN(t))this.integralDeduction=0;else{if(t>this.pointAviable)this.integralDeduction=100*Math.floor(this.pointAviable/100),this.$toast("本单最高抵扣"+this.pointAviable+"积分");else if(t<0)this.integralDeduction=0,this.$toast("抵扣积分不能为负数");else{var i=t;this.integralDeduction=100*Math.floor(t/100),i!=this.integralDeduction&&this.$toast("抵扣积分为整百")}this.pointAviablePersent=(this.integralDeduction/100).toFixed(2),this.billCodePoint=(parseFloat(this.bill_amount)-parseFloat(this.pointAviablePersent)).toFixed(2)}},integralInstructionFn:function(){this.$router.push({name:"readTextPage",params:{pageType:5}})},onClickLeft:function(){window.removeEventListener("native.keyboardhide",this.pointValid),cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),this.$router.back()},goToPay:function(){var t=this;if(this.billCodePoint<0)this.$toast("订单生成错误，金额不能为负数");else{var i={bill_no:this.billNo,point:this.integralDeduction+"",decount_money:this.pointAviablePersent,pay_money:this.billCodePoint};Object(s["k"])({data:JSON.stringify(i)}).then((function(i){1==i.result?(t.payParam=i.payParam,"1"==i.payParam.IS_ALI_PAY&&(t.isAlipay=!0),"1"==i.payParam.IS_WX_PAY&&(t.isWechart=!0),t.payWindowShow=!0,window.broadcaster.addEventListener("paymentBack",t.payCallBack)):t.$toast(i.msg?i.msg:"网络异常，请稍后重试！")})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))}},payCallBack:function(){this.checkOrderStatus()},checkOrderStatus:function(){var t=this;window.broadcaster.removeEventListener("paymentBack",this.payCallBack);var i={bill_code:this.billNo};Object(s["q"])({data:JSON.stringify(i)}).then((function(i){i.result?1==i.data.bill_status?(i.data.billType="账单缴费",t.$router.push({name:"paymentPaySuccess",params:{orderData:i.data}})):t.$toast({duration:500,message:"支付失败",onClose:function(){t.$router.back()}}):t.$toast(i.msg?i.msg:"网络异常，请稍后重试！")})).catch((function(i){t.$toast("网络异常，请稍后重试！")}))},closePopup:function(){this.payWindowShow=!1}}},u=h,m=(e("da7e"),e("2877")),p=Object(m["a"])(u,a,o,!1,null,"78ccf6bf",null);i["default"]=p.exports},da7e:function(t,i,e){"use strict";var a=e("48ae"),o=e.n(a);o.a}}]);
//# sourceMappingURL=chunk-dd1ae948.2020111117.js.map